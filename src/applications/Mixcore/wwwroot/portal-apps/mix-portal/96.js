"use strict";(self.webpackChunkmix_portal=self.webpackChunkmix_portal||[]).push([[96],{2096:(L,g,r)=>{r.r(g),r.d(g,{ROUTES:()=>U});var l=r(573),h=r(343),x=r(8505),f=r(3900),C=r(9646),e=r(5e3),v=r(6696),m=r(9808),S=r(9343),I=r(1163),b=r(7155);function y(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mix-init-site-information",9),e.\u0275\u0275listener("siteSubmit",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.siteSubmit(o))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}}function T(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mix-init-account-information",10),e.\u0275\u0275listener("accountSubmit",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.accountSubmit(o))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("loading",t.loading)}}function w(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mix-init-themes",11),e.\u0275\u0275listener("themeSubmit",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.themeSubmit(o))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("loading",t.loading)}}function P(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.downloadProgress,"% ")}}function M(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",12)(1,"div",13)(2,"h4"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(4,"progress",14),e.\u0275\u0275elementStart(5,"div",15)(6,"label",16),e.\u0275\u0275text(7," Init tenant "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"label",17),e.\u0275\u0275text(9),e.\u0275\u0275template(10,P,2,1,"span",3),e.\u0275\u0275elementEnd()()()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.progressMessage),e.\u0275\u0275advance(1),e.\u0275\u0275property("max",100)("value",t.initProgress),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",t.themeData?"Download "+t.themeData.title:"Blank theme"," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(1===t.initApplicationStep||2===t.initApplicationStep)&&t.themeData)}}const O=function(){return{closeable:!1,dismissible:!1}};let E=(()=>{class n{constructor(t,i,o,s,c){this.tenancyApi=t,this.route=i,this.themeSignal=o,this.alertService=s,this.modalService=c,this.step=0,this.loading=!1,this.showProgress=!1,this.initProgress=0,this.downloadProgress=0,this.initApplicationStep=1,this.progressMessage="Please wait while we install your site!"}siteSubmit(t){this.tenantData=t,this.step=1}accountSubmit(t){this.accountData=t,this.step=2}themeSubmit(t){this.themeData=t,this.modalService.confirm(t?`Choose ${t.title} is your default theme ?`:"Init site with a blank theme ?").subscribe(o=>{o&&this.initApplication()})}initApplication(){this.showProgress=!0;const t={tenantData:this.tenantData,accountData:this.accountData};setTimeout(()=>{this.initProgress<=30&&(this.initProgress=15)},1500),this.tenancyApi.initFullTenant(t).pipe((0,x.b)(()=>{this.initProgress=this.themeData?30:100,this.initApplicationStep=1}),(0,f.w)(()=>(this.themeData&&this.themeSignal.getMessage(l.ie.THEME_DOWNLOAD).subscribe(i=>{console.log(i),this.downloadProgress=i.data,this.initProgress=30+i.data}),this.themeData?this.tenancyApi.installTheme(this.themeData.additionalData):(0,C.of)(null)))).subscribe(()=>{this.initApplicationStep=2,this.progressMessage="Congratulation! Successfully init your site",this.alertService.open("Create your tenant successfully",{label:"Success"}).subscribe(),setTimeout(()=>{localStorage.setItem("redirectUrl","/init/setup-theme"),this.route.navigateByUrl("/auth/login")},2e3)})}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(l.fC),e.\u0275\u0275directiveInject(v.F0),e.\u0275\u0275directiveInject(l.Th),e.\u0275\u0275directiveInject(h.J9),e.\u0275\u0275directiveInject(l.Z7))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["mix-portal-init-page"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:16,vars:6,consts:[[1,"init-page"],[1,"init-page__form"],["src","assets/images/mixcore-logo-red-2.svg","width","100px",1,"margin-b-2"],[4,"ngIf"],[1,"margin-t-1"],[2,"color","#1DA1D1"],[1,"init-page__banner"],["src","assets/images/init-banner-01.jpg",1,"image"],[3,"tuiDialog","tuiDialogOptions","tuiDialogChange"],[3,"siteSubmit"],[3,"loading","accountSubmit"],[3,"loading","themeSubmit"],[1,"init-progress-dialog"],[1,"init-progress-dialog__title"],["tuiProgressBar","",3,"max","value"],[1,"init-progress-dialog__description","tui-space_top-2"],["tuiLabel","","label","Init tenant"],["tuiLabel","","label","Install theme"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275element(2,"img",2),e.\u0275\u0275template(3,y,2,0,"ng-container",3),e.\u0275\u0275template(4,T,2,1,"ng-container",3),e.\u0275\u0275template(5,w,2,1,"ng-container",3),e.\u0275\u0275elementStart(6,"p",4),e.\u0275\u0275text(7,"By signing up, you\u2019re agree to our "),e.\u0275\u0275elementStart(8,"a",5),e.\u0275\u0275text(9," Terms & Conditions "),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(10," and "),e.\u0275\u0275elementStart(11,"a",5),e.\u0275\u0275text(12," Privacy Policy "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(13,"div",6),e.\u0275\u0275element(14,"img",7),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(15,M,11,5,"ng-template",8),e.\u0275\u0275listener("tuiDialogChange",function(s){return i.showProgress=s})),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",0===i.step),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1===i.step),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",2===i.step),e.\u0275\u0275advance(10),e.\u0275\u0275property("tuiDialog",i.showProgress)("tuiDialogOptions",e.\u0275\u0275pureFunction0(5,O)))},dependencies:[l.Gn,m.O5,S.A,b.iv,I.iu,l.Pe,l.uz,l.f7],styles:[".init-page[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;justify-content:center;align-items:center}.init-page__form[_ngcontent-%COMP%]{width:500px;padding:20px}.init-page__banner[_ngcontent-%COMP%]{padding:20px;width:600px;display:flex;justify-content:center;align-items:center;flex-direction:column;text-align:center}.init-page__banner[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:350px;height:auto}.init-progress-dialog[_ngcontent-%COMP%]{width:500px;height:300px;display:flex;justify-content:center;align-items:center;flex-direction:column}.init-progress-dialog[_ngcontent-%COMP%]   tui-progress-segmented[_ngcontent-%COMP%]{width:100%}.init-progress-dialog__title[_ngcontent-%COMP%]{margin-bottom:20px}.init-progress-dialog__title[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-family:monospace;overflow:hidden;border-right:.15em solid orange;white-space:nowrap;margin:0 auto;animation:typing 2.5s steps(30,end),blink-caret .5s step-end infinite}.init-progress-dialog__description[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.init-progress-dialog__description[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{text-align:left}.init-progress-dialog__description[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{text-align:right}@keyframes typing{0%{width:0}to{width:100%}}@keyframes blink-caret{0%,to{border-color:transparent}50%{border-color:orange}}"]}),n})();var p=r(3075),V=r(9577),u=r(9367),d=r(946),_=r(3347);function D(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13)(2,"tui-checkbox-labeled",14),e.\u0275\u0275listener("ngModelChange",function(o){const c=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(c.selected=o)}),e.\u0275\u0275text(3),e.\u0275\u0275elementStart(4,"div",15),e.\u0275\u0275text(5,"Angular UI Kit for awesome people"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&n){const t=a.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",t.selected),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.item.displayName," ")}}function A(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275template(1,D,6,2,"ng-container",12),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.currentPages)}}function k(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13)(2,"tui-checkbox-labeled",14),e.\u0275\u0275listener("ngModelChange",function(o){const c=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(c.selected=o)}),e.\u0275\u0275text(3),e.\u0275\u0275elementStart(4,"div",15),e.\u0275\u0275text(5,"Angular UI Kit for awesome people"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&n){const t=a.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",t.selected),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.item.displayName," ")}}function j(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275template(1,k,6,2,"ng-container",12),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.currentModules)}}function F(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",13)(2,"tui-checkbox-labeled",14),e.\u0275\u0275listener("ngModelChange",function(o){const c=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(c.selected=o)}),e.\u0275\u0275text(3),e.\u0275\u0275elementStart(4,"div",15),e.\u0275\u0275text(5,"Angular UI Kit for awesome people"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&n){const t=a.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",t.selected),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.item.displayName," ")}}function $(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275template(1,F,6,2,"ng-container",12),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.currentPosts)}}function B(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"h3"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span"),e.\u0275\u0275text(4,"We also provide some data go with this theme, please select what you want"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",3)(6,"tui-tabs",4),e.\u0275\u0275listener("activeItemIndexChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.activeItemIndex=o)}),e.\u0275\u0275elementStart(7,"button",5),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.activeItemIndex=0)}),e.\u0275\u0275text(8," Pages "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",5),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.activeItemIndex=1)}),e.\u0275\u0275text(10," Modules "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"button",5),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.activeItemIndex=2)}),e.\u0275\u0275text(12," Posts "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(13,A,2,1,"div",6),e.\u0275\u0275template(14,j,2,1,"div",6),e.\u0275\u0275template(15,$,2,1,"div",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",7)(17,"div",8)(18,"p"),e.\u0275\u0275text(19),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"p"),e.\u0275\u0275text(21),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"p"),e.\u0275\u0275text(23),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(24,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onSelectAll())}),e.\u0275\u0275pipe(25,"async"),e.\u0275\u0275text(26," Select All "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"button",10),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onImport())}),e.\u0275\u0275pipe(28,"async"),e.\u0275\u0275text(29," Select "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("Hi, you have selected ",null==t.currentTheme?null:t.currentTheme.themeName," as the starting theme."),e.\u0275\u0275advance(4),e.\u0275\u0275property("activeItemIndex",t.activeItemIndex),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",0===t.activeItemIndex),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",1===t.activeItemIndex),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",2===t.activeItemIndex),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",t.currentSelectedPages.length," pages selected"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.currentSelectedModules.length," modules selected"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.currentSelectedPosts.length," posts selected"),e.\u0275\u0275advance(1),e.\u0275\u0275property("appearance","outline")("showLoader",!!e.\u0275\u0275pipeBind1(25,14,t.loading$))("size","m"),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",!t.currentSelectedPages.length&&!t.currentSelectedModules.length&&!t.currentSelectedPosts.length)("showLoader",!!e.\u0275\u0275pipeBind1(28,16,t.loading$))("size","m")}}function N(n,a){1&n&&e.\u0275\u0275element(0,"mix-skeleton-loading")}const U=[{path:"setup-theme",component:(()=>{class n extends l.H6{constructor(t,i){super(),this.tenancyApi=t,this.cdr=i,this.activeItemIndex=0,this.currentTheme=void 0,this.currentPages=[],this.currentModules=[],this.currentPosts=[]}get currentSelectedPosts(){return this.currentPosts.filter(t=>t.selected).map(t=>t.item)}get currentSelectedPages(){return this.currentPages.filter(t=>t.selected).map(t=>t.item)}get currentSelectedModules(){return this.currentModules.filter(t=>t.selected).map(t=>t.item)}ngOnInit(){this.tenancyApi.loadTheme().subscribe(t=>{this.currentTheme=t,this.currentModules=t.modules.map(i=>({item:i,selected:!1})),this.currentPages=t.pages.map(i=>({item:i,selected:!1})),this.currentPosts=t.posts.map(i=>({item:i,selected:!1})),this.loading$.next(!1),this.cdr.detectChanges()})}onSelectAll(){this.onImport()}onImport(){if(this.loading$.next(!0),this.currentTheme){const t=Object.assign({},this.currentTheme);this.tenancyApi.importTheme(t).subscribe({next:()=>{this.showSuccess("Successfully setup data for your site"),setTimeout(()=>{this.route.navigateByUrl("/portal")},1500)},error:()=>{this.showError("Something wrong, please try again"),this.loading$.next(!1)}})}}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(l.fC),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["mix-setup-theme"]],standalone:!0,features:[e.\u0275\u0275InheritDefinitionFeature,e.\u0275\u0275StandaloneFeature],decls:4,vars:2,consts:[[1,"setup-theme-page"],[4,"ngIf","ngIfElse"],["loading",""],[1,"setup-theme-page__main-container","container"],[3,"activeItemIndex","activeItemIndexChange"],["tuiTab","",3,"click"],["class","row",4,"ngIf"],[1,"setup-theme-page__footer","container"],[1,"info"],["tuiButton","",3,"appearance","showLoader","size","click"],["tuiButton","",3,"disabled","showLoader","size","click"],[1,"row"],[4,"ngFor","ngForOf"],[1,"col-3"],[1,"item",3,"ngModel","ngModelChange"],[1,"with-data"]],template:function(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,B,30,18,"ng-container",1),e.\u0275\u0275template(2,N,1,0,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&t){const o=e.\u0275\u0275reference(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.currentTheme)("ngIfElse",o)}},dependencies:[m.ez,m.sg,m.O5,m.Ov,p.FormsModule,p.NgControlStatus,p.NgModel,V.r,d.$$,d.H9,d.yu,_.s,_.p,u.fN,u.v0],styles:[".setup-theme-page[_ngcontent-%COMP%]{height:100vh;width:100vw;display:flex;align-items:center;flex-direction:column;padding-top:50px}.setup-theme-page[_ngcontent-%COMP%]   tui-tabs[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:30px}.setup-theme-page[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin-top:10px}.setup-theme-page[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .with-data[_ngcontent-%COMP%]{margin-top:5px;color:var(--tui-text-03)}.setup-theme-page__footer[_ngcontent-%COMP%]{padding-top:20px;margin-top:30px;border-top:1px solid var(--tui-base-03);display:flex;justify-content:flex-start;align-items:center}.setup-theme-page__footer[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{margin-right:auto}.setup-theme-page__footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),n})()},{path:"",component:E}]}}]);