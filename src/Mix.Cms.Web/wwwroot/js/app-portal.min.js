demo = {
    initDashboardPageCharts: function (incomes,services) {
        incomes = incomes || [50, 150, 100, 190, 130, 90, 150, 160, 120, 140, 190, 95]
        chartColor = "#eeeeee";
        // General configuration for the charts with Line gradientStroke
        gradientChartOptionsConfiguration = {
            maintainAspectRatio: false,
            legend: {
                display: false
            },
            tooltips: {
                bodySpacing: 4,
                mode: "nearest",
                intersect: 0,
                position: "nearest",
                xPadding: 10,
                yPadding: 10,
                caretPadding: 10
            },
            responsive: 1,
            scales: {
                yAxes: [{
                    display: 0,
                    gridLines: 0,
                    ticks: {
                        display: false
                    },
                    gridLines: {
                        zeroLineColor: "transparent",
                        drawTicks: false,
                        display: false,
                        drawBorder: false
                    }
                }],
                xAxes: [{
                    display: 0,
                    gridLines: 0,
                    ticks: {
                        display: false
                    },
                    gridLines: {
                        zeroLineColor: "transparent",
                        drawTicks: false,
                        display: false,
                        drawBorder: false
                    }
                }]
            },
            layout: {
                padding: { left: 0, right: 0, top: 15, bottom: 15 }
            }
        };

        gradientChartOptionsConfigurationWithNumbersAndGrid = {
            maintainAspectRatio: false,
            legend: {
                display: false
            },
            tooltips: {
                bodySpacing: 4,
                mode: "nearest",
                intersect: 0,
                position: "nearest",
                xPadding: 10,
                yPadding: 10,
                caretPadding: 10
            },
            responsive: true,
            scales: {
                yAxes: [{
                    gridLines: 0,
                    gridLines: {
                        zeroLineColor: "transparent",
                        drawBorder: false
                    }
                }],
                xAxes: [{
                    display: 0,
                    gridLines: 0,
                    ticks: {
                        display: false
                    },
                    gridLines: {
                        zeroLineColor: "transparent",
                        drawTicks: false,
                        display: false,
                        drawBorder: false
                    }
                }]
            },
            layout: {
                padding: { left: 0, right: 0, top: 15, bottom: 15 }
            }
        };

        var ctx = document.getElementById('bigDashboardChart').getContext("2d");

        var gradientStroke = ctx.createLinearGradient(500, 0, 100, 0);
        gradientStroke.addColorStop(0, '#80b6f4');
        gradientStroke.addColorStop(1, chartColor);

        var gradientFill = ctx.createLinearGradient(0, 200, 0, 50);
        gradientFill.addColorStop(0, "rgba(128, 182, 244, 0)");
        gradientFill.addColorStop(1, "rgba(255, 255, 255, 0.24)");

        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"],
                datasets: [
                    {
                        type: 'line',
                        label: "Incomes",
                        borderColor: chartColor,
                        pointBorderColor: chartColor,
                        pointBackgroundColor: "red",
                        pointHoverBackgroundColor: "#1e3d60",
                        pointHoverBorderColor: chartColor,
                        pointBorderWidth: 1,
                        pointHoverRadius: 7,
                        pointHoverBorderWidth: 2,
                        pointRadius: 5,
                        fill: true,
                        backgroundColor: gradientFill,
                        borderWidth: 2,
                        data: incomes
                    },
                    {                        
                        label: "Services",
                        //borderColor: chartColor,
                        //pointBorderColor: chartColor,
                        //pointBackgroundColor: "#1e3d60",
                        //pointHoverBackgroundColor: "#1e3d60",
                        //pointHoverBorderColor: chartColor,
                        //pointBorderWidth: 1,
                        //pointHoverRadius: 7,
                        //pointHoverBorderWidth: 2,
                        //pointRadius: 5,
                        //fill: true,
                        backgroundColor: 'yellow',
                        //borderWidth: 2,
                        data: services
                    }
                ]
            },
            options: {
                layout: {
                    padding: {
                        left: 20,
                        right: 20,
                        top: 0,
                        bottom: 0
                    }
                },
                maintainAspectRatio: false,
                tooltips: {
                    backgroundColor: '#fff',
                    titleFontColor: '#333',
                    bodyFontColor: '#666',
                    bodySpacing: 4,
                    xPadding: 12,
                    mode: "nearest",
                    intersect: 0,
                    position: "nearest"
                },
                legend: {
                    position: "bottom",
                    fillStyle: "#FFF",
                    display: false
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            fontColor: "rgba(255,255,255,0.4)",
                            fontStyle: "bold",
                            beginAtZero: true,
                            maxTicksLimit: 5,
                            padding: 10
                        },
                        gridLines: {
                            drawTicks: true,
                            drawBorder: false,
                            display: true,
                            color: "rgba(255,255,255,0.1)",
                            zeroLineColor: "transparent"
                        }

                    }],
                    xAxes: [{
                        gridLines: {
                            zeroLineColor: "transparent",
                            display: false,

                        },
                        ticks: {
                            padding: 10,
                            fontColor: "rgba(255,255,255,0.4)",
                            fontStyle: "bold"
                        }
                    }]
                }
            }
        });
    },
};

'use strict';
app.controller('AppSettingsController', 
    ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 
'AuthService','CommonService', 'AppSettingsServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, commonServices, appSettingsServices) {

        $scope.appSettings = null;
        $scope.errors = [];
        $scope.statuses = ngAppSettings.contentStatuses;
        $scope.getAppSettings = async function (id) {
            $rootScope.isBusy = true;
            var resp = await appSettingsServices.getAppSettings();
            if (resp && resp.isSucceed) {
                $scope.appSettings = resp.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadAppSettings = async function () {
            $rootScope.isBusy = true;

            var id = $routeParams.id;
            var response = await appSettingsServices.getAppSettings();
            if (response.isSucceed) {
                $scope.appSettings = response.data;
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }

            var result = await commonServices.getSettings();
            if (result.isSucceed) {
                $scope.settings = result.data;
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.isBusy = false;
            }
        };

        $scope.saveAppSettings = async function (appSettings) {
            $rootScope.isBusy = true;
            var resp = await appSettingsServices.saveAppSettings(appSettings);
            if (resp && resp.isSucceed) {
                $scope.appSettings = resp.data;
                $rootScope.showMessage('success', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $scope.$apply();
            }
        };

    }]);

'use strict';
app.factory('AppSettingsServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var appSettingssServiceFactory = {};

    var settings = $rootScope.globalSettings

    var _getAppSettings = async function () {
        var url = '/api/portal/app-settings/details';
        
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _saveAppSettings = async function (appSettings) {
        var apiUrl = '/api/portal/app-settings/save';
        var req = {
            method: 'POST',
            url: apiUrl,
            data: JSON.stringify(appSettings)
        };
        return await commonServices.getApiResult(req)
    };

    appSettingssServiceFactory.getAppSettings = _getAppSettings;
    appSettingssServiceFactory.saveAppSettings = _saveAppSettings;
    return appSettingssServiceFactory;

}]);

'use strict';
app.controller('ArticleController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', 'ArticleService',
    function ($scope, $rootScope, ngAppSettings, $routeParams, service) {
        BaseCtrl.call(this, $scope, $rootScope, $routeParams, ngAppSettings, service);
        $scope.preview = function (item) {
            $rootScope.preview('article', item, item.title, 'modal-lg');
        };
    }]);

'use strict';
app.factory('ArticleService', ['BaseService',
    function (baseService) {
        baseService.init('article');
        var serviceFactory = baseService;
        // Define more service methods here
        return serviceFactory;
    }]);

'use strict';
app.controller('ConfigurationController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'ConfigurationServices','GlobalSettingsService',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, configurationServices, GlobalSettingsService) {
        $scope.request = angular.copy(ngAppSettings.request);

        $scope.request.contentStatuses = [
            'Site',
            'System'
        ];
        $scope.request.status = '0';
        $scope.configurationFile = {
            file: null,
            fullPath: '',
            folder: 'Configuration',
            title: '',
            description: ''
        };
        $scope.cates = [
            'Site',
            'System'
        ];
        $scope.dataTypes = ngAppSettings.editorConfigurations.dataTypes;
        $scope.activedConfiguration = null;
        $scope.relatedConfigurations = [];
        $rootScope.isBusy = false;
        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0
        };
        $scope.errors = [];

        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };
        $scope.initEditors = function () {
            $rootScope.initEditor();
        };

        $scope.getConfiguration = async function (id) {
            $rootScope.isBusy = true;
            var resp = await configurationServices.getConfiguration(id, 'portal');
            if (resp && resp.isSucceed) {
                $scope.activedConfiguration = resp.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadConfiguration = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await configurationServices.getConfiguration(id, 'portal');
            if (response.isSucceed) {
                $scope.activedConfiguration = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadConfigurations = async function (pageIndex) {
            if (pageIndex !== undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            $rootScope.isBusy = true;
            var resp = await configurationServices.getConfigurations($scope.request);
            if (resp && resp.isSucceed) {

                $scope.data = resp.data;
                $.each($scope.data.items, function (i, configuration) {

                    $.each($scope.activedConfigurations, function (i, e) {
                        if (e.configurationId === configuration.id) {
                            configuration.isHidden = true;
                        }
                    });
                });
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeConfiguration = function (id) {
            $rootScope.showConfirm($scope, 'removeConfigurationConfirmed', [id], null, 'Remove Configuration', 'Are you sure');
        };

        $scope.removeConfigurationConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await configurationServices.removeConfiguration(id);
            if (result.isSucceed) {
                GlobalSettingsService.reset($rootScope.globalSettings.lang).then(function () {
                    window.location.href = '/portal/configuration/list';
                });
            }
            else {
                $rootScope.showErrors(result.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.saveConfiguration = async function (configuration) {
            configuration.content = $('.editor-content').val();
            configuration.dataType = configuration.property.dataType;
            $rootScope.isBusy = true;
            var resp = await configurationServices.saveConfiguration(configuration);
            if (resp && resp.isSucceed) {
                $scope.activedConfiguration = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                
                GlobalSettingsService.reset($rootScope.globalSettings.lang).then(function () {
                    window.location.href = '/portal/configuration/list';
                });
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

    }]);

'use strict';
app.factory('ConfigurationServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var configurationsServiceFactory = {};

    var settings = $rootScope.globalSettings

    var _getConfiguration = async function (id, type) {
        var apiUrl = '/' + settings.lang + '/configuration/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _initConfiguration = async function (type) {
        var apiUrl = '/' + settings.lang + '/configuration/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getConfigurations = async function (request) {
        var apiUrl = '/' + settings.lang + '/configuration/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeConfiguration = async function (id) {
        var apiUrl = '/' + settings.lang + '/configuration/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveConfiguration = async function (configuration) {
        var apiUrl = '/' + settings.lang + '/configuration/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(configuration)
        };
        return await commonServices.getApiResult(req)
    };
    var _uploadConfiguration = async function (configurationFile) {
        //var container = $(this).parents('.model-configuration').first().find('.custom-file').first();
        if (configurationFile.file !== undefined && configurationFile.file !== null) {
            // Create FormData object
            var files = new FormData();

            // Looping over all files and add it to FormData object
            files.append(configurationFile.file.name, configurationFile.file);

            // Adding one more key to FormData object
            files.append('fileFolder', configurationFile.folder); files.append('title', configurationFile.title);
            files.append('description', configurationFile.description);

            var req = {
                url: '/' + settings.lang + '/configuration/upload', //'/api/tts/UploadImage',
                type: "POST",
                headers: {
                },
                contentType: false, // Not to set any content header
                processData: false, // Not to process data
                data: files,
            };

            return await commonServices.getApiResult(req)
        }
    };

    configurationsServiceFactory.getConfiguration = _getConfiguration;
    configurationsServiceFactory.initConfiguration = _initConfiguration;
    configurationsServiceFactory.getConfigurations = _getConfigurations;
    configurationsServiceFactory.removeConfiguration = _removeConfiguration;
    configurationsServiceFactory.saveConfiguration = _saveConfiguration;
    configurationsServiceFactory.uploadConfiguration = _uploadConfiguration;
    return configurationsServiceFactory;

}]);

'use strict';
app.controller('CultureController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'CultureServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, cultureServices) {
        $scope.request = {
            pageSize: '10',
            pageIndex: 0,
            status: '2',
            orderBy: 'Priority',
            direction: '0',
            fromDate: null,
            toDate: null,
            keyword: ''
        };
        $scope.cultures = [

            { specificulture: 'en-us', fullName: 'United States - English (Default)', icon: 'flag-icon-us' },
            { specificulture: 'fr-dz', fullName: 'Algeria - Français', icon: 'flag-icon-dz' },
            { specificulture: 'es-ar', fullName: 'Argentina - Español', icon: 'flag-icon-ar' },
            { specificulture: 'en-au', fullName: 'Australia - English', icon: 'flag-icon-au' },
            { specificulture: 'nl-be', fullName: 'België - Nederlands', icon: 'flag-icon-be' },
            { specificulture: 'fr-be', fullName: 'Belgique - Français', icon: 'flag-icon-be' },
            { specificulture: 'es-bo', fullName: 'Bolivia - Español', icon: 'flag-icon-bo' },
            { specificulture: 'bs-ba', fullName: 'Bosna i Hercegovina – Bosanski', icon: 'flag-icon-ba' },
            { specificulture: 'pt-br', fullName: 'Brasil - Português', icon: 'flag-icon-br' },
            { specificulture: 'en-ca', fullName: 'Canada - English', icon: 'flag-icon-ca' },
            { specificulture: 'fr-ca', fullName: 'Canada - Français', icon: 'flag-icon-ca' },
            { specificulture: 'cs-cz', fullName: 'Česká Republika - Čeština', icon: 'flag-icon-cz' },
            { specificulture: 'es-cl', fullName: 'Chile - Español', icon: 'flag-icon-cl' },
            { specificulture: 'es-co', fullName: 'Colombia - Español', icon: 'flag-icon-co' },
            { specificulture: 'es-cr', fullName: 'Costa Rica - Español', icon: 'flag-icon-cr' },
            { specificulture: 'sr-latn-me', fullName: 'Crna Gora - Srpski', icon: 'flag-icon-me' },
            { specificulture: 'en-cy', fullName: 'Cyprus - English', icon: 'flag-icon-cy' },
            { specificulture: 'da-dk', fullName: 'Danmark - Dansk', icon: 'flag-icon-dk' },
            { specificulture: 'de-de', fullName: 'Deutschland - Deutsch', icon: 'flag-icon-de' },
            { specificulture: 'es-ec', fullName: 'Ecuador - Español', icon: 'flag-icon-ec' },
            { specificulture: 'et-ee', fullName: 'Eesti - Eesti', icon: 'flag-icon-ee' },
            { specificulture: 'en-eg', fullName: 'Egypt - English', icon: 'flag-icon-eg' },
            { specificulture: 'es-sv', fullName: 'El Salvador - Español', icon: 'flag-icon-sv' },
            { specificulture: 'es-es', fullName: 'España - Español', icon: 'flag-icon-es' },
            { specificulture: 'fr-fr', fullName: 'France - Français', icon: 'flag-icon-fr' },
            { specificulture: 'es-gt', fullName: 'Guatemala - Español', icon: 'flag-icon-gt' },
            { specificulture: 'en-gulf', fullName: 'Gulf - English', icon: 'flag-icon-lf' },
            { specificulture: 'es-hn', fullName: 'Honduras - Español', icon: 'flag-icon-hn' },
            { specificulture: 'en-hk', fullName: 'Hong Kong SAR - English', icon: 'flag-icon-hk' },
            { specificulture: 'hr-hr', fullName: 'Hrvatska - Hrvatski', icon: 'flag-icon-hr' },
            { specificulture: 'en-in', fullName: 'India - English', icon: 'flag-icon-in' },
            { specificulture: 'id-id', fullName: 'Indonesia - Bahasa Indonesia', icon: 'flag-icon-id' },
            { specificulture: 'en-ie', fullName: 'Ireland - English', icon: 'flag-icon-ie' },
            { specificulture: 'is-is', fullName: 'Ísland - Íslenska', icon: 'flag-icon-is' },
            { specificulture: 'it-it', fullName: 'Italia - Italiano', icon: 'flag-icon-it' },
            { specificulture: 'en-jo', fullName: 'Jordan - English', icon: 'flag-icon-jo' },
            { specificulture: 'lv-lv', fullName: 'Latvija - Latviešu', icon: 'flag-icon-lv' },
            { specificulture: 'en-lb', fullName: 'Lebanon - English', icon: 'flag-icon-lb' },
            { specificulture: 'lt-lt', fullName: 'Lietuva - Lietuvių', icon: 'flag-icon-lt' },
            { specificulture: 'hu-hu', fullName: 'Magyarország - Magyar', icon: 'flag-icon-hu' },
            { specificulture: 'en-my', fullName: 'Malaysia - English', icon: 'flag-icon-my' },
            { specificulture: 'en-mt', fullName: 'Malta - English', icon: 'flag-icon-mt' },
            { specificulture: 'es-mx', fullName: 'México - Español', icon: 'flag-icon-mx' },
            { specificulture: 'fr-ma', fullName: 'Morocco - Français', icon: 'flag-icon-ma' },
            { specificulture: 'nl-nl', fullName: 'Nederland - Nederlands', icon: 'flag-icon-nl' },
            { specificulture: 'en-nz', fullName: 'New Zealand - English', icon: 'flag-icon-nz' },
            { specificulture: 'es-ni', fullName: 'Nicaragua - Español', icon: 'flag-icon-ni' },
            { specificulture: 'en-ng', fullName: 'Nigeria - English', icon: 'flag-icon-ng' },
            { specificulture: 'nb-no', fullName: 'Norge - Bokmål', icon: 'flag-icon-no' },
            { specificulture: 'de-at', fullName: 'Österreich - Deutsch', icon: 'flag-icon-at' },
            { specificulture: 'en-pk', fullName: 'Pakistan - English', icon: 'flag-icon-pk' },
            { specificulture: 'es-pa', fullName: 'Panamá - Español', icon: 'flag-icon-pa' },
            { specificulture: 'es-py', fullName: 'Paraguay - Español', icon: 'flag-icon-py' },
            { specificulture: 'es-pe', fullName: 'Perú - Español', icon: 'flag-icon-pe' },
            { specificulture: 'en-ph', fullName: 'Philippines - English', icon: 'flag-icon-ph' },
            { specificulture: 'pl-pl', fullName: 'Polska - Polski', icon: 'flag-icon-pl' },
            { specificulture: 'pt-pt', fullName: 'Portugal - Português', icon: 'flag-icon-pt' },
            { specificulture: 'es-pr', fullName: 'Puerto Rico - Español', icon: 'flag-icon-pr' },
            { specificulture: 'es-do', fullName: 'República Dominicana - Español', icon: 'flag-icon-do' },
            { specificulture: 'ro-md', fullName: 'Republica Moldova - Română', icon: 'flag-icon-md' },
            { specificulture: 'ro-ro', fullName: 'România - Română', icon: 'flag-icon-ro' },
            { specificulture: 'en-sa', fullName: 'Saudi Arabia - English', icon: 'flag-icon-sa' },
            { specificulture: 'de-ch', fullName: 'Schweiz - Deutsch', icon: 'flag-icon-ch' },
            { specificulture: 'en-sg', fullName: 'Singapore - English', icon: 'flag-icon-sg' },
            { specificulture: 'sl-si', fullName: 'Slovenija - Slovenščina', icon: 'flag-icon-si' },
            { specificulture: 'sk-sk', fullName: 'Slovensko - Slovenčina', icon: 'flag-icon-sk' },
            { specificulture: 'en-za', fullName: 'South Africa - English', icon: 'flag-icon-za' },
            { specificulture: 'sr-latn-rs', fullName: 'Srbija - Srpski', icon: 'flag-icon-rs' },
            { specificulture: 'en-lk', fullName: 'Sri Lanka - English', icon: 'flag-icon-lk' },
            { specificulture: 'fr-ch', fullName: 'Suisse - Français', icon: 'flag-icon-ch' },
            { specificulture: 'fi-fi', fullName: 'Suomi - Suomi', icon: 'flag-icon-fi' },
            { specificulture: 'sv-se', fullName: 'Sverige - Svenska', icon: 'flag-icon-se' },
            { specificulture: 'fr-tn', fullName: 'Tunisia - Français', icon: 'flag-icon-tn' },
            { specificulture: 'tr-tr', fullName: 'Türkiye - Türkçe', icon: 'flag-icon-tr' },
            { specificulture: 'en-gb', fullName: 'United Kingdom - English', icon: 'flag-icon-gb' },
            { specificulture: 'en-us', fullName: 'United States - English', icon: 'flag-icon-us' },
            { specificulture: 'es-uy', fullName: 'Uruguay - Español', icon: 'flag-icon-uy' },
            { specificulture: 'es-ve', fullName: 'Venezuela - Español', icon: 'flag-icon-ve' },
            { specificulture: 'vi-vn', fullName: 'Việt Nam - Tiếng việt', icon: 'flag-icon-vn' },
            { specificulture: 'el-gr', fullName: 'Ελλάδα - Ελληνικά', icon: 'flag-icon-gr' },
            { specificulture: 'ru-by', fullName: 'Беларусь - Беларуская', icon: 'flag-icon-by' },
            { specificulture: 'bg-bg', fullName: 'България - Български', icon: 'flag-icon-bg' },
            { specificulture: 'ru-kz', fullName: 'Казахстан - Русский', icon: 'flag-icon-kz' },
            { specificulture: 'ru-ru', fullName: 'Россия - Русский', icon: 'flag-icon-ru' },
            { specificulture: 'uk-ua', fullName: 'Україна - Українська', icon: 'flag-icon-ua' },
            { specificulture: 'he-il', fullName: 'ישראל - עברית', icon: 'flag-icon-il' },
            { specificulture: 'ar-iq', fullName: 'العراق - العربية', icon: 'flag-icon-iq' },
            { specificulture: 'ar-sa', fullName: 'المملكة العربية السعودية - العربية', icon: 'flag-icon-sa' },
            { specificulture: 'ar-ly', fullName: 'ليبيا - العربية', icon: 'flag-icon-ly' },
            { specificulture: 'ar-eg', fullName: 'مصر - العربية', icon: 'flag-icon-eg' },
            { specificulture: 'ar-gulf', fullName: 'دول الخليج - العربية', icon: 'flag-icon-lf' },
            { specificulture: 'th-th', fullName: 'ไทย - ไทย', icon: 'flag-icon-th' },
            { specificulture: 'ko-kr', fullName: '대한민국 - 한국어', icon: 'flag-icon-kr' },
            { specificulture: 'zh-cn', fullName: '中国 - 简体中文', icon: 'flag-icon-cn' },
            { specificulture: 'zh-tw', fullName: '台灣 - 繁體中文', icon: 'flag-icon-tw' },
            { specificulture: 'ja-jp', fullName: '日本 - 日本語', icon: 'flag-icon-jp' },
            { specificulture: 'zh-hk', fullName: '香港特別行政區 - 繁體中文', icon: 'flag-icon-hk' }

        ]
        $scope.icons = [
            'flag-icon-us',
            'flag-icon-vn',
            'flag-icon-gb',
            'flag-icon-fr',
            'flag-icon-cn',
            'flag-icon-be',
        ];
        $scope.activedCulture = null;

        $scope.relatedCultures = [];

        $rootScope.isBusy = false;

        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0
        };

        $scope.errors = [];

        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };

        $scope.getCulture = async function (id) {
            $rootScope.isBusy = true;
            var resp = await cultureServices.getCulture(id, 'portal');
            if (resp && resp.isSucceed) {
                $scope.activedCulture = resp.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.syncTemplates = async function (id) {
            $rootScope.isBusy = true;
            var response = await cultureServices.syncTemplates(id);
            if (response.isSucceed) {
                $scope.activedCulture = response.data;
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadCulture = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await cultureServices.getCulture(id, 'portal');
            if (response.isSucceed) {
                $scope.activedCulture = response.data;
                if (!id) {
                    $scope.activedCulture.icon = $scope.icons[0];
                }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadCultures = async function (pageIndex) {
            if (pageIndex != undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            if ($scope.request.fromDate != null) {
                var d = new Date($scope.request.fromDate);
                $scope.request.fromDate = d.toISOString();
            }
            if ($scope.request.toDate != null) {
                var d = new Date($scope.request.toDate);
                $scope.request.toDate = d.toISOString();
            }
            $rootScope.isBusy = true;
            var resp = await cultureServices.getCultures($scope.request);
            if (resp && resp.isSucceed) {
                ($scope.data = resp.data);
                //$("html, body").animate({ "scrollTop": "0px" }, 500);
                $.each($scope.data.items, function (i, culture) {
                    $.each($scope.activedCultures, function (i, e) {
                        if (e.cultureId == culture.id) {
                            culture.isHidden = true;
                        }
                    })
                })
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.saveCulture = async function (culture) {
            culture.content = $('.editor-content').val();
            $rootScope.isBusy = true;
            var resp = await cultureServices.saveCulture(culture);
            if (resp && resp.isSucceed) {
                $scope.activedCulture = resp.data;
                $rootScope.showMessage('success', 'success');
                $rootScope.isBusy = false;
                $rootScope.updateSettings();
                window.location.href = '/portal/culture/list';
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeCulture = function (id) {
            $rootScope.showConfirm($scope, 'removeCultureConfirmed', [id], null, 'Remove Culture', 'Are you sure');
        }

        $scope.removeCultureConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await cultureServices.removeCulture(id);
            if (result.isSucceed) {
                $rootScope.updateSettings();
                window.location.href = '/portal/culture/list';
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        }

        $scope.changeIcon = function (icon) {
            $scope.activedCulture.icon = icon;
        }
    }]);
'use strict';
app.factory('CultureServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var culturesServiceFactory = {};

    var _getCulture = async function (id, type) {
        var apiUrl = '/api/culture/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _syncTemplates = async function (id) {
        var apiUrl = '/api/culture/';
        var url = apiUrl + 'sync/' + id;        
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _initCulture = async function (type) {
        var apiUrl = '/api/culture/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getCultures = async function (request) {
        var apiUrl = '/api/culture/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeCulture = async function (id) {
        var apiUrl = '/api/culture/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveCulture = async function (culture) {
        var apiUrl = '/api/culture/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(culture)
        };
        return await commonServices.getApiResult(req)
    };

    culturesServiceFactory.syncTemplates = _syncTemplates;
    culturesServiceFactory.getCulture = _getCulture;
    culturesServiceFactory.initCulture = _initCulture;
    culturesServiceFactory.getCultures = _getCultures;
    culturesServiceFactory.removeCulture = _removeCulture;
    culturesServiceFactory.saveCulture = _saveCulture;
    return culturesServiceFactory;

}]);

'use strict';
app.controller('CustomerController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'CustomerServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, customerServices) {
        $scope.request = angular.copy(ngAppSettings.request);
        $scope.request.contentStatuses = [
            'Active'
        ];
        $scope.request.status = '0';
        $scope.activedCustomer = null;
        $scope.relatedCustomers = [];
        $rootScope.isBusy = false;
        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0,
        };
        $scope.errors = [];
        
        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };
        
        $scope.loadCustomer = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await customerServices.getCustomer(id, 'portal');
            if (response.isSucceed) {
                $scope.activedCustomer = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadCustomers = async function (pageIndex) {
            
            if (pageIndex != undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            if ($scope.request.fromDate != null) {
                var d = new Date($scope.request.fromDate);
                $scope.request.fromDate = d.toISOString();
            }
            if ($scope.request.toDate != null) {
                var d = new Date($scope.request.toDate);
                $scope.request.toDate = d.toISOString();
            }
            var resp = await customerServices.getCustomers($scope.request);
            if (resp && resp.isSucceed) {

                ($scope.data = resp.data);
                //$("html, body").animate({ "scrollTop": "0px" }, 500);
                $.each($scope.data.items, function (i, customer) {

                    $.each($scope.activedCustomers, function (i, e) {
                        if (e.customerId == customer.id) {
                            customer.isHidden = true;
                        }
                    })
                })
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $scope.$apply();
            }
        };

        $scope.removeCustomer = function (id) {
            $rootScope.showConfirm($scope, 'removeCustomerConfirmed', [id], null, 'Remove Customer', 'Are you sure');
        }

        $scope.removeCustomerConfirmed = async function (id) {
            var result = await customerServices.removeCustomer(id);
            if (result.isSucceed) {
                $rootScope.showMessage('success', 'success');
                $scope.loadCustomers();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        }


        $scope.saveCustomer = async function (customer) {
            customer.content = $('.editor-content').val();
            var resp = await customerServices.saveCustomer(customer);
            if (resp && resp.isSucceed) {
                $scope.activedCustomer = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
                //$location.path('/portal/customer/details/' + resp.data.id);
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $scope.$apply();
            }
        };

    }]);

'use strict';
app.factory('CustomerServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var customersServiceFactory = {};

    var settings = $rootScope.globalSettings

    var _getCustomer = async function (id, type) {
        var apiUrl = '/api/queen-beauty/customer/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _initCustomer = async function (type) {
        var apiUrl = '/api/queen-beauty/customer/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getCustomers = async function (request) {
        var apiUrl = '/api/queen-beauty/customer/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeCustomer = async function (id) {
        var apiUrl = '/api/queen-beauty/customer/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveCustomer = async function (customer) {
        var apiUrl = '/api/queen-beauty/customer/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(customer)
        };
        return await commonServices.getApiResult(req)
    };

    customersServiceFactory.getCustomer = _getCustomer;
    customersServiceFactory.initCustomer = _initCustomer;
    customersServiceFactory.getCustomers = _getCustomers;
    customersServiceFactory.removeCustomer = _removeCustomer;
    customersServiceFactory.saveCustomer = _saveCustomer;
    return customersServiceFactory;

}]);

'use strict';
app.controller('DashboardController', ['$scope', '$rootScope', 'ngAppSettings', '$timeout', '$location', 'DashboardServices', function ($scope, $rootScope, ngAppSettings, $timeout, $location, dashboardServices) {
    $scope.pageClass = 'page-dashboard';
    $('.side-nav li').removeClass('active');
    $('.side-nav .page-dashboard').addClass('active');
    $scope.data = {
        totalPage: 0,
        totalArticle: 0,
        totalProduct: 0,
        totalUser: 0
    }
    $scope.users = [];
    $scope.$on('$viewContentLoaded', function () {
        $rootScope.isBusy = false;

    });
    $scope.getDashboardInfo = async function () {
        $rootScope.isBusy = true;
        var response = await dashboardServices.getDashboardInfo();
        if (response.isSucceed) {
            $scope.data = response.data;
            $rootScope.isBusy = false;
            $scope.$apply();
        }
        else {
            $rootScope.showErrors(response.errors);
            $rootScope.isBusy = false;
            $scope.$apply();
        }
    }
}]);

'use strict';
app.factory('DashboardServices', ['$http', 'CommonService', function ($http, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var usersServiceFactory = {};
    var apiUrl = '/portal/';
    var _getDashboardInfo = async function () {
        var req = {
            method: 'GET',
            url: apiUrl + 'dashboard'
        };

        return await commonServices.getApiResult(req);
    };

    usersServiceFactory.getDashboardInfo = _getDashboardInfo;
    return usersServiceFactory;

}]);

'use strict';
app.controller('FileController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'FileServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, fileServices) {
        $scope.request = {
            pageSize: '10',
            pageIndex: 0,
            status: '2',
            orderBy: 'CreatedDateTime',
            direction: '1',
            fromDate: null,
            toDate: null,
            keyword: '',
            key: ''
        };

        $scope.activedFile = null;
        $scope.relatedFiles = [];
        $rootScope.isBusy = false;
        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0,
        };
        $scope.errors = [];

        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };

        $scope.loadFile = async function () {
            $rootScope.isBusy = true;
            $scope.listUrl = '/portal/file/list?folder=' + $routeParams.folder;
            $rootScope.isBusy = true;
            var response = await fileServices.getFile($routeParams.folder, $routeParams.filename);
            if (response.isSucceed) {
                $scope.activedFile = response.data;                
                $rootScope.isBusy = false;
                $scope.$apply();
                $rootScope.initEditor();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadFiles = async function (folder) {
            if (folder) {
                $scope.request.key += ($scope.request.key != '') ? '/' : '';
                $scope.request.key += folder;
            } else {
                $scope.request.key = $routeParams.folder ? $routeParams.folder : '';
            }
            $rootScope.isBusy = true;
            var resp = await fileServices.getFiles($scope.request);
            if (resp && resp.isSucceed) {

                ($scope.data = resp.data);
                $.each($scope.data.items, function (i, file) {

                    $.each($scope.activedFiles, function (i, e) {
                        if (e.fileId == file.id) {
                            file.isHidden = true;
                        }
                    })
                })
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeFile = async function (id) {
            if (confirm("Are you sure!")) {
                $rootScope.isBusy = true;
                var resp = await fileServices.removeFile(id);
                if (resp && resp.isSucceed) {
                    $scope.loadFiles();
                }
                else {
                    if (resp) { $rootScope.showErrors(resp.errors); }
                    $rootScope.isBusy = false;
                    $scope.$apply();
                }
            }
        };

        $scope.saveFile = async function (file) {
            file.content = $('.code-content').val();
            $rootScope.isBusy = true;
            var resp = await fileServices.saveFile(file);
            if (resp && resp.isSucceed) {
                $scope.activedFile = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

    }]);

'use strict';
app.factory('FileServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var filesServiceFactory = {};

    var settings = $rootScope.globalSettings

    var _getFile = async function (folder, filename) {
        var apiUrl = '/api/file/';
        var url = apiUrl + 'details?folder=' + folder + '&filename=' + filename;        
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _initFile = async function (type) {
        var apiUrl = '/api/file/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getFiles = async function (request) {
        var apiUrl = '/api/file/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeFile = async function (id) {
        var apiUrl = '/api/file/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveFile = async function (file) {
        var apiUrl = '/api/file/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(file)
        };
        return await commonServices.getApiResult(req)
    };

    filesServiceFactory.getFile = _getFile;
    filesServiceFactory.initFile = _initFile;
    filesServiceFactory.getFiles = _getFiles;
    filesServiceFactory.removeFile = _removeFile;
    filesServiceFactory.saveFile = _saveFile;
    return filesServiceFactory;

}]);

'use strict';
app.controller('ImportFileController',
    ['$scope', '$rootScope', 'ImportFileServices', 'TranslatorService', 'GlobalSettingsService', 
        function ($scope, $rootScope, importFileServices, translatorService, GlobalSettingsService) {

            $scope.importFile = {
                title: '',
                description: '',
                postedFile: {
                    file: null,
                    fullPath: '',
                    folderName: 'Import',
                    fileFolder: 'Import',
                    fileName: '',
                    extension: '',
                    content: '',
                    fileStream: ''
                }
            };
            $scope.importType = 'Language';
            $scope.types = [
                'Language',
                'Configuration'
            ];
            $scope.errors = [];
            $scope.saveImportFile = async function (importFile, importType) {
                $rootScope.isBusy = true;
                var resp = await importFileServices.saveImportFile(importFile.postedFile, importType);
                if (resp && resp.isSucceed) {
                    $scope.activedImportFile = resp.data;
                    $rootScope.showMessage('Success', 'success');
                    switch (importType) {
                        case 'Language':
                            translatorService.reset($rootScope.globalSettings.lang).then(function () {
                                window.location.href = '/portal/language/list';
                            });
                            return false;
                        case 'Configuration':
                            GlobalSettingsService.reset($rootScope.globalSettings.lang).then(function () {
                                window.location.href = '/portal/configuration/list';
                            });
                            return false;
                    }


                }
                else {
                    if (resp) { $rootScope.showErrors(resp.errors); }
                    $rootScope.isBusy = false;
                    $scope.$apply();
                }
            };
        }]);

'use strict';
app.factory('ImportFileServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var importFilesServiceFactory = {};

    var settings = $rootScope.globalSettings;

    var _saveImportFile = async function (importFile, type) {
        var apiUrl = '/api/portal/' + settings.lang + '/import/' + type;
        var req = {
            method: 'POST',
            url: apiUrl,
            data: JSON.stringify(importFile)
        };
        return await commonServices.getApiResult(req);
    };

    importFilesServiceFactory.saveImportFile = _saveImportFile;
    return importFilesServiceFactory;

}]);

'use strict';
app.controller('LanguageController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location'
    , 'AuthService', 'LanguageServices', 'CommonService', 'TranslatorService',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, languageServices, commonServices, translatorService) {
        $scope.request = {
            pageSize: '10',
            pageIndex: 0,
            status: '2',
            orderBy: 'CreatedDateTime',
            direction: '1',
            fromDate: null,
            toDate: null,
            keyword: ''
        };
        $scope.languageFile = {
            file: null,
            fullPath: '',
            folder: 'Language',
            title: '',
            description: ''
        };
        $scope.cates = [
            {
                title: 'Common',
                prefix: ''
            },
            {
                title: 'Portal',
                prefix: 'portal_'
            },
            {
                title: 'Frontend',
                prefix: 'fe_'
            }
        ];
        $scope.cate = $scope.cates[0];
        $scope.dataTypes = ngAppSettings.editorConfigurations.dataTypes;
        $scope.activedLanguage = null;
        $scope.relatedLanguages = [];
        $rootScope.isBusy = false;
        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0,
        };
        $scope.errors = [];

        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };
        $scope.initEditors = function () {
            $rootScope.initEditor();
        }
        $scope.getLanguage = async function (id) {
            $rootScope.isBusy = true;
            var resp = await languageServices.getLanguage(id, 'portal');
            if (resp && resp.isSucceed) {

                $scope.activedLanguage = resp.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadLanguage = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await languageServices.getLanguage(id, 'api');
            if (response.isSucceed) {
                $scope.activedLanguage = response.data;
                if (!id) {
                    $scope.activedLanguage.category = 'Common';
                }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadLanguages = async function (pageIndex) {
            if (pageIndex !== undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            $rootScope.isBusy = true;
            var resp = await languageServices.getLanguages($scope.request);
            if (resp && resp.isSucceed) {

                $scope.data = resp.data;
                $.each($scope.data.items, function (i, language) {

                    $.each($scope.activedLanguages, function (i, e) {
                        if (e.languageId === language.id) {
                            language.isHidden = true;
                        }
                    });
                });
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeLanguage = function (id) {
            $rootScope.showConfirm($scope, 'removeLanguageConfirmed', [id], null, 'Remove Language', 'Are you sure');
        };

        $scope.removeLanguageConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await languageServices.removeLanguage(id);
            if (result.isSucceed) {
                commonServices.removeTranslator();
                $scope.loadLanguages();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.saveLanguage = async function (language) {
            language.content = $('.editor-content').val();
            language.dataType = language.property.dataType;
            var resp = await languageServices.saveLanguage(language);
            if (resp && resp.isSucceed) {
                $scope.activedLanguage = resp.data;
                commonServices.removeTranslator();
                $rootScope.showMessage('success', 'success');

                translatorService.reset($rootScope.globalSettings.lang).then(function () {
                    window.location.href = '/portal/language/list';
                });

            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.generateDefault = function (text, cate) {
            if (!$routeParams.id) {
                $scope.activedLanguage.defaultValue = text;
                $scope.activedLanguage.keyword = cate.prefix + text.replace(/[^a-zA-Z0-9]+/g, '_')
                    .replace(/([A-Z]+)([A-Z][a-z])/g, '$1-$2')
                    .replace(/([a-z])([A-Z])/g, '$1-$2')
                    .replace(/([0-9])([^0-9])/g, '$1-$2')
                    .replace(/([^0-9])([0-9])/g, '$1-$2')
                    .replace(/-+/g, '_')
                    .toLowerCase();
            }
        };

    }]);

'use strict';
app.factory('LanguageServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var languagesServiceFactory = {};

    var settings = $rootScope.globalSettings

    var _getLanguage = async function (id, type) {
        var apiUrl = '/' + settings.lang + '/language/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _initLanguage = async function (type) {
        var apiUrl = '/' + settings.lang + '/language/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getLanguages = async function (request) {
        var apiUrl = '/' + settings.lang + '/language/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeLanguage = async function (id) {
        var apiUrl = '/' + settings.lang + '/language/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveLanguage = async function (language) {
        var apiUrl = '/' + settings.lang + '/language/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(language)
        };
        return await commonServices.getApiResult(req)
    };
    var _uploadLanguage = async function (languageFile) {
        //var container = $(this).parents('.model-language').first().find('.custom-file').first();
        if (languageFile.file !== undefined && languageFile.file !== null) {
            // Create FormData object
            var files = new FormData();

            // Looping over all files and add it to FormData object
            files.append(languageFile.file.name, languageFile.file);

            // Adding one more key to FormData object
            files.append('fileFolder', languageFile.folder); files.append('title', languageFile.title);
            files.append('description', languageFile.description);

            var req = {
                url: '/' + settings.lang + '/language/upload', //'/api/tts/UploadImage',
                type: "POST",
                headers: {
                },
                contentType: false, // Not to set any content header
                processData: false, // Not to process data
                data: files,
            };

            return await commonServices.getApiResult(req)
        }
    };

    languagesServiceFactory.getLanguage = _getLanguage;
    languagesServiceFactory.initLanguage = _initLanguage;
    languagesServiceFactory.getLanguages = _getLanguages;
    languagesServiceFactory.removeLanguage = _removeLanguage;
    languagesServiceFactory.saveLanguage = _saveLanguage;
    languagesServiceFactory.uploadLanguage = _uploadLanguage;
    return languagesServiceFactory;

}]);

'use strict';
app.factory('MediaServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var mediasServiceFactory = {};

    var settings = $rootScope.globalSettings

    var _getMedia = async function (id, type) {
        var apiUrl = settings.lang + '/media/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _initMedia = async function (type) {
        var apiUrl = '/' + settings.lang + '/media/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getMedias = async function (request) {
        var apiUrl = '/' + settings.lang + '/media/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeMedia = async function (id) {
        var apiUrl = '/' + settings.lang + '/media/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveMedia = async function (media) {
        var apiUrl = '/' + settings.lang + '/media/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(media)
        };
        return await commonServices.getApiResult(req)
    };
    var _uploadMedia = async function (mediaFile) {
        //var container = $(this).parents('.model-media').first().find('.custom-file').first();
        if (mediaFile.file !== undefined && mediaFile.file !== null) {
            // Create FormData object
            var files = new FormData();

            // Looping over all files and add it to FormData object
            files.append(mediaFile.file.name, mediaFile.file);

            // Adding one more key to FormData object
            files.append('fileFolder', mediaFile.folder); files.append('title', mediaFile.title);
            files.append('description', mediaFile.description);

            var req = {
                url: '/' + settings.lang + '/media/upload', //'/tts/UploadImage',
                type: "POST",
                headers: {
                    'Content-Type': 'multipart/form-data'
                },
                contentType: false, // Not to set any content header
                processData: false, // Not to process data
                data: files,
            };

            return await commonServices.getApiResult(req)
        }
    };

    mediasServiceFactory.getMedia = _getMedia;
    mediasServiceFactory.initMedia = _initMedia;
    mediasServiceFactory.getMedias = _getMedias;
    mediasServiceFactory.removeMedia = _removeMedia;
    mediasServiceFactory.saveMedia = _saveMedia;
    mediasServiceFactory.uploadMedia = _uploadMedia;
    return mediasServiceFactory;

}]);

'use strict';
app.controller('loginController', [ '$rootScope', '$scope', 'ngAppSettings', '$location', 'AuthService', 'ngAppSettings', function ($rootScope, $scope, ngAppSettings, $location, authService, ngAuthSettings) {
    if (authService.authentication && authService.authentication.isAuth && authService.authentication.isAdmin) {
        authService.referredUrl = $location.path();
        $location.path('/portal');
    }

    $scope.pageClass = 'page-login';

    $scope.loginData = {
        username: "",
        password: "",
        rememberme: false
    };

    $scope.message = "";
    $scope.$on('$viewContentLoaded', function () {
        $rootScope.isBusy = false;
    });
    $scope.login = async function () {
        
        if (authService.referredUrl == "/portal/login") {
            authService.referredUrl = "/portal";
        }
        $rootScope.isBusy = true;
        var result = await authService.login($scope.loginData);
        if (result) {
            $rootScope.isBusy = false;
            $scope.$apply();
        }
    };

$scope.authExternalProvider = function (provider) {

    var redirectUri = location.protocol + '//' + location.host + '/authcomplete.html';

    var externalProviderUrl = ngAuthSettings.apiServiceBaseUri + "api/Account/ExternalLogin?provider=" + provider
        + "&response_type=token&client_id=" + ngAuthSettings.clientId
        + "&redirect_uri=" + redirectUri;
    window.$windowScope = $scope;

    var oauthWindow = window.open(externalProviderUrl, "Authenticate Account", "location=0,status=0,width=600,height=750");
};

$scope.authCompletedCB = function (fragment) {

    $scope.$apply(function () {

        if (fragment.haslocalaccount == 'False') {

            authService.logOut();

            authService.externalAuthData = {
                provider: fragment.provider,
                userName: fragment.external_user_name,
                externalAccessToken: fragment.external_access_token
            };

            $location.path('/associate');

        }
        else {
            //Obtain access token and redirect to orders
            var externalData = { provider: fragment.provider, externalAccessToken: fragment.external_access_token };
            authService.obtainAccessToken(externalData).then(function (response) {

                $location.path('/orders');

            },
                function (err) {
                    $scope.message = err.error_description;
                });
        }

    });
}
}]);
'use strict';
app.controller('ModuleController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', 
    'ModuleService', 'ModuleDataService',
    function ($scope, $rootScope, ngAppSettings, $routeParams, moduleServices, moduleDataService) {
        BaseCtrl.call(this, $scope, $rootScope, $routeParams, ngAppSettings, moduleServices, 'product');
        $scope.defaultAttr = {
            name: '',
            options: [],
            priority: 0,
            dataType: 0,
            isGroupBy: false,
            isSelect: false,
            isDisplay: true,
            width: 3
        };
        $scope.dataTypes = ngAppSettings.editorConfigurations.dataTypes;
        $scope.activedData = null;

        $scope.loadModuleDatas = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await moduleServices.getSingle([id, 'portal']);
            if (response.isSucceed) {
                $scope.activedData = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadMoreModuleDatas = async function (pageIndex) {
            $scope.request.key = $scope.activedData.id;
            if (pageIndex !== undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            if ($scope.request.fromDate !== null) {
                var d = new Date($scope.request.fromDate);
                $scope.request.fromDate = d.toISOString();
            }
            if ($scope.request.toDate !== null) {
                var d = new Date($scope.request.toDate);
                $scope.request.toDate = d.toISOString();
            }
            $rootScope.isBusy = true;
            var resp = await moduleDataService.getModuleDatas($scope.request);
            if (resp && resp.isSucceed) {

                $scope.activedData.data = resp.data;
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.addAttr = function () {
            if ($scope.activedData) {
                var t = angular.copy($scope.defaultAttr);
                $scope.activedData.columns.push(t);
            }
        };

        $scope.addOption = function (col, index) {
            var val = angular.element('#option_' + index).val();
            col.options.push(val);
            angular.element('#option_' + index).val('');
        };

        $scope.generateName = function(col){
            $rootScope.generateKeyword(col.title, '_');
        }
        $scope.removeAttr = function (index) {
            if ($scope.activedData) {

                $scope.activedData.columns.splice(index, 1);
            }
        }

        $scope.removeData = function (id) {
            if ($scope.activedData) {
                $rootScope.showConfirm($scope, 'removeDataConfirmed', [id], null, 'Remove Data', 'Are you sure');
            }
        }

        $scope.removeDataConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await moduleDataService.removeModuleData(id);
            if (result.isSucceed) {
                $scope.loadModuleDatas();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        }
        $scope.updateModuleDataField = async function (item, propertyName){
            var result = await moduleDataService.saveFields(item.id, propertyName, item[propertyName]);
            if (result.isSucceed) {
                $scope.loadModuleDatas();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        }
    }]);

'use strict';
app.factory('ModuleService', ['BaseService',
    function (baseService) {
        baseService.init('module')
        var serviceFactory = baseService;
        // Define more service methods here
        return serviceFactory;
    }]);

'use strict';
app.controller('OrderController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'OrderServices', 'ngAppSettings',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, orderServices) {
        $scope.request = angular.copy(ngAppSettings.request);
        $scope.request.contentStatuses = [
            'Waiting',
            'Serving',
            'Rated',
            'Finished'
        ];
        $scope.request.status = '2';
        $scope.activedOrder = null;
        $scope.relatedOrders = [];
        $rootScope.isBusy = false;
        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0,
            items: []
        };
        $scope.errors = [];

        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        }

        $scope.loadOrder = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await orderServices.getOrder(id, 'portal');
            if (response.isSucceed) {
                $scope.activedOrder = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadOrders = async function (pageIndex) {
            if (pageIndex !== undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            if ($scope.request.fromDate !== null) {
                var d = new Date($scope.request.fromDate);
                $scope.request.fromDate = d.toISOString();
            }
            if ($scope.request.toDate !== null) {
                var d = new Date($scope.request.toDate);
                $scope.request.toDate = d.toISOString();
            }
            $rootScope.isBusy = true;
            var resp = await orderServices.getOrders($scope.request);
            if (resp && resp.isSucceed) {

                ($scope.data = resp.data);
                //$("html, body").animate({ "scrollTop": "0px" }, 500);
                $.each($scope.data.items, function (i, order) {

                    $.each($scope.activedOrders, function (i, e) {
                        if (e.orderId === order.id) {
                            order.isHidden = true;
                        }
                    })
                })
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeOrder = function (id) {
            $rootScope.showConfirm($scope, 'removeOrderConfirmed', [id], null, 'Remove Order', 'Are you sure');
        };

        $scope.removeOrderConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await orderServices.removeOrder(id);
            if (result.isSucceed) {
                $scope.loadOrders();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.saveOrder = async function (order) {
            order.content = $('.editor-content.content').val();
            order.excerpt = $('.editor-content.excerpt').val();
            $rootScope.isBusy = true;
            var resp = await orderServices.saveOrder(order);
            if (resp && resp.isSucceed) {
                $scope.activedOrder = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
                //$location.path('/portal/order/details/' + resp.data.id);
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.preview = function (item) {
            $rootScope.preview('order', item, item.title, 'modal-lg');
        };
    }]);

'use strict';
app.factory('OrderServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var ordersServiceFactory = {};

    var settings = $rootScope.globalSettings

    var _getOrder = async function (id, type) {
        var apiUrl = '/' + settings.lang + '/order/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _initOrder = async function (type) {
        var apiUrl = '/' + settings.lang + '/order/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getOrders = async function (request) {
        var apiUrl = '/' + settings.lang + '/order/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeOrder = async function (id) {
        var apiUrl = '/' + settings.lang + '/order/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveOrder = async function (order) {
        var apiUrl = '/' + settings.lang + '/order/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(order)
        };
        return await commonServices.getApiResult(req)
    };

    ordersServiceFactory.getOrder = _getOrder;
    ordersServiceFactory.initOrder = _initOrder;
    ordersServiceFactory.getOrders = _getOrders;
    ordersServiceFactory.removeOrder = _removeOrder;
    ordersServiceFactory.saveOrder = _saveOrder;
    return ordersServiceFactory;

}]);

'use strict';
app.controller('PageController', 
            ['$scope', '$rootScope', '$routeParams', 'ngAppSettings', 'PageService',
    function ($scope, $rootScope, $routeParams, ngAppSettings, service) {
        BaseCtrl.call(this, $scope, $rootScope, $routeParams, ngAppSettings, service);        
        $scope.request.query = 'level=0';        
        $scope.loadPageDatas = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await pageServices.getPage(id, 'portal');
            if (response.isSucceed) {
                $scope.activedData = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.updateInfos = async function (items) {
            $rootScope.isBusy = true;
            var resp = await pageServices.updateInfos(items);
            if (resp && resp.isSucceed) {
                $scope.activedData = resp.data;
                $rootScope.showMessage('success', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

    }]);

'use strict';
app.factory('PageService', ['$rootScope', 'CommonService', 'BaseService',
    function ($rootScope, commonServices, baseService) {

        var serviceFactory = Object.create(baseService);
        serviceFactory.init('page');
        var _updateInfos = async function (pages) {

            var req = {
                method: 'POST',
                url: this.prefixUrl + '/update-infos',
                data: JSON.stringify(pages)
            };
            return await commonServices.getApiResult(req);
        };
        serviceFactory.updateInfos = _updateInfos;
        return serviceFactory;

    }]);

'use strict';
app.controller('PortalPageController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'PortalPageServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, pageServices) {
        $scope.request = {
            pageSize: '10',
            pageIndex: 0,
            status: '2',
            orderBy: 'Priority',
            direction: '0',
            fromDate: null,
            toDate: null,
            keyword: '',
            key: 'fe'
        };

        $scope.activedPage = null;

        $scope.relatedPages = [];

        $rootScope.isBusy = false;

        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0
        };
        $scope.columns= [
            {
                title:'Keyword',
                name:'textKeyword',
                filter: true,
                type: 0 // string - ngAppSettings.dataTypes[0]
            },
            {
                title:'Default',
                name:'textDefault',
                filter: true,
                type: 0 // string - ngAppSettings.dataTypes[0]
            },
            {
                title:'Description',
                name:'description',
                filter: true,
                type: 0 // string - ngAppSettings.dataTypes[0]
            },
            {
                title:'Created Date',
                name:'createdDateTime',
                filter: true,
                type: 0 // string - ngAppSettings.dataTypes[0]
            },
        ];
        $scope.errors = [];

        $scope.range = $rootScope.range;

        $scope.getPage = async function (id) {
            $rootScope.isBusy = true;
            var resp = await pageServices.getPage(id, 'portal');
            if (resp && resp.isSucceed) {
                $scope.activedPage = resp.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.initPage = function () {
            if (!$rootScope.isBusy) {
                $rootScope.isBusy = true;
                pageServices.initPage('portal').then(function (response) {
                    if (response.isSucceed) {
                        $scope.activedPage = response.data;
                        $rootScope.initEditor();
                    }
                    $rootScope.isBusy = false;
                    $rootScope.isBusy = false;
                    $scope.$apply();
                }).error(function (a, b, c) {
                    errors.push(a, b, c);
                    $rootScope.isBusy = false;
                });
            }
        };

        $scope.loadPage = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            $rootScope.isBusy = true;
            var response = await pageServices.getPage(id, 'portal');
            if (response.isSucceed) {
                $scope.activedPage = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadPages = async function (pageIndex) {
            if (pageIndex !== undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            if ($scope.request.fromDate !== null) {
                var d = new Date($scope.request.fromDate);
                $scope.request.fromDate = d.toISOString();
            }
            if ($scope.request.toDate !== null) {
                var d = new Date($scope.request.toDate);
                $scope.request.toDate = d.toISOString();
            }
            var resp = await pageServices.getPages($scope.request);
            if (resp && resp.isSucceed) {

                ($scope.data = resp.data);
                $.each($scope.data.items, function (i, page) {

                    $.each($scope.activedPages, function (i, e) {
                        if (e.pageId === page.id) {
                            page.isHidden = true;
                        }
                    });
                });
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removePage = function (id) {
            $rootScope.showConfirm($scope, 'removePageConfirmed', [id], null, 'Remove Page', 'Are you sure');
        };

        $scope.removePageConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await pageServices.removePage(id);
            if (result.isSucceed) {
                $scope.loadPages();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };


        $scope.savePage = async function (page) {
            page.content = $('.editor-content').val();
            $rootScope.isBusy = true;
            var resp = await pageServices.savePage(page);
            if (resp && resp.isSucceed) {
                $scope.activedPage = resp.data;
                $rootScope.showMessage('success', 'success');
                $rootScope.isBusy = false;
                $location.path('/portal/portal-page/list');
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.updateInfos = async function (items) {
            $rootScope.isBusy = true;
            var resp = await pageServices.updateInfos(items);
            if (resp && resp.isSucceed) {
                $scope.activedPage = resp.data;
                $rootScope.showMessage('success', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.updateChildInfos = async function (items) {
            $rootScope.isBusy = true;
            var resp = await pageServices.updateChildInfos(items);
            if (resp && resp.isSucceed) {
                $scope.activedPage = resp.data;
                $rootScope.showMessage('success', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
    }]);

'use strict';
app.factory('PortalPageServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    var pagesServiceFactory = {};

    var _getPage = async function (id, type) {
        var apiUrl = '/api/portal-page/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req);
    };

    var _initPage = async function (type) {
        var apiUrl = '/api/portal-page/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type
        };
        return await commonServices.getApiResult(req);
    };

    var _getPages = async function (request) {
        var apiUrl = '/api/portal-page/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list/0',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removePage = async function (id) {
        var apiUrl = '/api/portal-page/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req);
    };

    var _savePage = async function (page) {
        var apiUrl = '/api/portal-page/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(page)
        };
        return await commonServices.getApiResult(req);
    };

    var _updateInfos = async function (pages) {
        var apiUrl = '/api/portal-page/';
        var req = {
            method: 'POST',
            url: apiUrl + 'update-infos',
            data: JSON.stringify(pages)
        };
        return await commonServices.getApiResult(req);
    };

    var _updateChildInfos = async function (pages) {
        var apiUrl = '/api/portal-page/';
        var req = {
            method: 'POST',
            url: apiUrl + 'update-child-infos',
            data: JSON.stringify(pages)
        };
        return await commonServices.getApiResult(req);
    };

    pagesServiceFactory.getPage = _getPage;
    pagesServiceFactory.initPage = _initPage;
    pagesServiceFactory.getPages = _getPages;
    pagesServiceFactory.removePage = _removePage;
    pagesServiceFactory.savePage = _savePage;
    pagesServiceFactory.updateInfos = _updateInfos;
    pagesServiceFactory.updateChildInfos = _updateChildInfos;
    return pagesServiceFactory;

}]);

'use strict';
app.controller('ProductController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', 'ProductService',
    function ($scope, $rootScope, ngAppSettings, $routeParams, service) {        
        BaseCtrl.call(this, $scope, $rootScope, $routeParams, ngAppSettings, service);
        $scope.preview = function (item) {
            $rootScope.preview('product', item, item.title, 'modal-lg');
        };
    }]);

'use strict';
app.factory('ProductService', ['BaseService',
    function (baseService) {
        var serviceFactory = Object.create(baseService);
        serviceFactory.init('product');
        var _getSingle = function () {

        }
        // Define more service methods here
        serviceFactory.getSingle = _getSingle;
        return serviceFactory;
    }]);

'use strict';
app.controller('QueenDashboardController', ['$scope', '$rootScope', '$timeout', '$location', 'QueenDashboardServices', function ($scope, $rootScope, $timeout, $location, dashboardServices) {
    $scope.pageClass = 'page-dashboard';
    $('.side-nav li').removeClass('active');
    $('.side-nav .page-dashboard').addClass('active');
    $scope.data = {
        totalPage: 0,
        totalArticle: 0,
        totalProduct: 0,
        totalUser: 0
    };
    $scope.users = [];
    $scope.$on('$viewContentLoaded', function () {
        $rootScope.isBusy = false;

    });
    $scope.getDashboardInfo = async function () {
        var response = await dashboardServices.getDashboardInfo();
        if (response.isSucceed) {
            var incomes = [];
            var services = [];
            angular.forEach(response.data.statitics, function (value, key) {
                incomes.push(value.totalSpent);
                services.push(value.totalService);
            });
            setTimeout(function () {
                demo.initDashboardPageCharts(incomes, services);
            }, 2000)
            $scope.data = response.data;
            $scope.$apply();
        }
        else {
            $rootScope.showErrors(response.errors);
            $scope.$apply();
        }
    }
}]);
'use strict';
app.factory('QueenDashboardServices', ['$http', 'CommonService', function ($http, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var usersServiceFactory = {};
    var apiUrl = '/api/en-us/queen-beauty/';
    var _getDashboardInfo = async function () {
        var req = {
            method: 'GET',
            url: apiUrl + 'dashboard'
        };

        return await commonServices.getApiResult(req);
    };

    usersServiceFactory.getDashboardInfo = _getDashboardInfo;
    return usersServiceFactory;

}]);

'use strict';
app.controller('RoleController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'RoleServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, roleServices) {
        $scope.request = {
            pageSize: '10',
            pageIndex: 0,
            status: '2',
            orderBy: 'CreatedDateTime',
            direction: '1',
            fromDate: null,
            toDate: null,
            keyword: ''
        };
        $scope.activedRole = null;
        $scope.relatedRoles = [];
        $rootScope.isBusy = false;
        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0
        };
        $scope.errors = [];
        $scope.role = { name: '' };
        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };

        $scope.loadRole = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await roleServices.getRole(id, 'portal');
            if (response.isSucceed) {
                $scope.activedRole = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadRoles = async function (pageIndex) {
            if (pageIndex !== undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            $rootScope.isBusy = true;
            var resp = await roleServices.getRoles($scope.request);
            if (resp && resp.isSucceed) {
                $scope.data = resp.data;
                $.each($scope.data.items, function (i, role) {

                    $.each($scope.data, function (i, e) {
                        if (e.roleId === role.id) {
                            role.isHidden = true;
                        }
                    });
                });
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeRole = function (id) {
            $rootScope.showConfirm($scope, 'removeRoleConfirmed', [id], null, 'Remove Role', 'Are you sure');
        };

        $scope.removeRoleConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await roleServices.removeRole(id);
            if (result.isSucceed) {
                $scope.loadRoles();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.createRole = async function () {
            $rootScope.isBusy = true;
            var result = await roleServices.createRole($scope.role.name);
            if (result.isSucceed) {
                $scope.role.name = '';
                $scope.loadRoles();
            }
            else {
                $rootScope.showMessage(result.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };


        $scope.saveRole = async function (role) {
            $rootScope.isBusy = true;
            var resp = await roleServices.saveRole(role);
            if (resp && resp.isSucceed) {
                $scope.activedRole = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
    }]);

'use strict';
app.factory('RoleServices', ['$http', 'CommonService', function ($http, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var rolesServiceFactory = {};
    var apiUrl = '/api/role/';
    
    var _getRoles = function (request) {

        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: request
        };

        return commonServices.getApiResult(req);
    };

    var _getRole = async function (id, viewType) {
        var apiUrl = '/api/role/';
        var url = apiUrl + 'details/' + viewType;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req);
    };

    var _getPermissions = async function () {
        var apiUrl = '/api/role/';
        var req = {
            method: 'GET',
            url: apiUrl + 'permissions'
        };
        return await commonServices.getApiResult(req);
    };

    var _saveRole = async function (role) {
        var apiUrl = '/api/role/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(role)
        };
        return await commonServices.getApiResult(req);
    };

    var _updatePermission = async function (permission) {
        var apiUrl = '/api/role/';
        var req = {
            method: 'POST',
            url: apiUrl + 'update-permission',
            data: JSON.stringify(permission)
        };
        return await commonServices.getApiResult(req);
    };

    var _removeRole = function (role) {
        var req = {
            method: 'POST',
            url: apiUrl + 'delete',
            data: JSON.stringify(role)
        };

        return commonServices.getApiResult(req);
    };

    var _createRole = function (name) {
        var req = {
            method: 'POST',
            url: apiUrl + 'create',
            data: JSON.stringify(name)
        };

        return commonServices.getApiResult(req);
    };

    rolesServiceFactory.getRoles = _getRoles;
    rolesServiceFactory.getPermissions = _getPermissions;
    rolesServiceFactory.getRole = _getRole;
    rolesServiceFactory.updatePermission = _updatePermission;
    rolesServiceFactory.saveRole = _saveRole;
    rolesServiceFactory.createRole = _createRole;
    rolesServiceFactory.removeRole = _removeRole;
    return rolesServiceFactory;

}]);

'use strict';
app.controller('ThemeController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'ThemeServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, themeServices) {
        $scope.request = {
            pageSize: '10',
            pageIndex: 0,
            status: '2',
            orderBy: 'Priority',
            direction: '0',
            fromDate: null,
            toDate: null,
            keyword: ''
        };

        $scope.activedTheme = null;

        $scope.relatedThemes = [];

        $rootScope.isBusy = false;

        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0
        };

        $scope.errors = [];

        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };

        $scope.getTheme = async function (id) {
            $rootScope.isBusy = true;
            var resp = await themeServices.getTheme(id, 'portal');
            if (resp && resp.isSucceed) {
                $scope.activedTheme = resp.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.syncTemplates = async function (id) {
            $rootScope.isBusy = true;
            var response = await themeServices.syncTemplates(id);
            if (response.isSucceed) {
                $scope.activedTheme = response.data;
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadTheme = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await themeServices.getTheme(id, 'portal');
            if (response.isSucceed) {
                $scope.activedTheme = response.data;
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
        $scope.loadThemes = async function (pageIndex) {
            if (pageIndex != undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            if ($scope.request.fromDate != null) {
                var d = new Date($scope.request.fromDate);
                $scope.request.fromDate = d.toISOString();
            }
            if ($scope.request.toDate != null) {
                var d = new Date($scope.request.toDate);
                $scope.request.toDate = d.toISOString();
            }
            $rootScope.isBusy = true;
            var resp = await themeServices.getThemes($scope.request);
            if (resp && resp.isSucceed) {

                ($scope.data = resp.data);
                //$("html, body").animate({ "scrollTop": "0px" }, 500);
                $.each($scope.data.items, function (i, theme) {

                    $.each($scope.activedThemes, function (i, e) {
                        if (e.themeId == theme.id) {
                            theme.isHidden = true;
                        }
                    })
                })
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.saveTheme = async function (theme) {
            $rootScope.isBusy = true;
            var resp = await themeServices.saveTheme(theme);
            if (resp && resp.isSucceed) {
                $scope.activedTheme = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $rootScope.updateSettings();
                $location.path('/portal/theme/list');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeTheme = function (id) {
            $rootScope.showConfirm($scope, 'removeThemeConfirmed', [id], null, 'Remove Theme', 'Are you sure');
        };

        $scope.removeThemeConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await themeServices.removeTheme(id);
            if (result.isSucceed) {
                $scope.loadThemes();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        }
    }]);

'use strict';
app.factory('ThemeServices', ['$http', '$rootScope', 'CommonService', function ($http, $rootScope, commonServices) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var themesServiceFactory = {};

    var settings = $rootScope.globalSettings;

    var _getTheme = async function (id, type) {
        var apiUrl = '/' + settings.lang + '/theme/';
        var url = apiUrl + 'details/' + type;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _syncTemplates = async function (id) {
        var apiUrl = '/' + settings.lang + '/theme/';
        var url = apiUrl + 'sync/' + id;        
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req,'');
    };

    var _initTheme = async function (type) {
        var apiUrl = '/' + settings.lang + '/theme/';
        var req = {
            method: 'GET',
            url: apiUrl + 'init/' + type,
        };
        return await commonServices.getApiResult(req)
    };

    var _getThemes = async function (request) {
        var apiUrl = '/' + settings.lang + '/theme/';
        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: JSON.stringify(request)
        };
        
        return await commonServices.getApiResult(req);
    };

    var _removeTheme = async function (id) {
        var apiUrl = '/' + settings.lang + '/theme/';
        var req = {
            method: 'GET',
            url: apiUrl + 'delete/' + id
        };
        return await commonServices.getApiResult(req)
    };

    var _saveTheme = async function (theme) {
        var apiUrl = '/' + $rootScope.globalSettings.lang + '/theme/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(theme)
        };
        return await commonServices.getApiResult(req);
    };

    themesServiceFactory.syncTemplates = _syncTemplates;
    themesServiceFactory.getTheme = _getTheme;
    themesServiceFactory.initTheme = _initTheme;
    themesServiceFactory.getThemes = _getThemes;
    themesServiceFactory.removeTheme = _removeTheme;
    themesServiceFactory.saveTheme = _saveTheme;
    return themesServiceFactory;

}]);

'use strict';
app.controller('UserController', ['$scope', '$rootScope', 'ngAppSettings', '$routeParams', '$timeout', '$location', 'AuthService', 'UserServices',
    function ($scope, $rootScope, ngAppSettings, $routeParams, $timeout, $location, authService, userServices) {
        $scope.request = {
            pageSize: '10',
            pageIndex: 0,
            status: '2',
            orderBy: 'CreatedDateTime',
            direction: '1',
            fromDate: null,
            toDate: null,
            keyword: ''
        };
        
        $scope.mediaFile = {
            file: null,
            fullPath: '',
            folder: 'User',
            title: '',
            description: ''
        };
        $scope.activedUser = null;
        $scope.relatedUsers = [];
        $rootScope.isBusy = false;
        $scope.data = {
            pageIndex: 0,
            pageSize: 1,
            totalItems: 0,
        };
        $scope.errors = [];

        $scope.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };

        $scope.loadUser = async function () {
            $rootScope.isBusy = true;
            var id = $routeParams.id;
            var response = await userServices.getUser(id, 'portal');
            if (response.isSucceed) {
                $scope.activedUser = response.data;
                $rootScope.initEditor();
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                $rootScope.showErrors(response.errors);
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.loadUsers = async function (pageIndex) {
            if (pageIndex != undefined) {
                $scope.request.pageIndex = pageIndex;
            }
            $rootScope.isBusy = true;
            var resp = await userServices.getUsers($scope.request);
            if (resp && resp.isSucceed) {
                $scope.data = resp.data;
                $.each($scope.data.items, function (i, user) {

                    $.each($scope.data, function (i, e) {
                        if (e.userId === user.id) {
                            user.isHidden = true;
                        }
                    });
                });
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.removeUser = function (id) {
            $rootScope.showConfirm($scope, 'removeUserConfirmed', [id], null, 'Remove User', 'Are you sure');
        }

        $scope.removeUserConfirmed = async function (id) {
            $rootScope.isBusy = true;
            var result = await userServices.removeUser(id);
            if (result.isSucceed) {
                $scope.loadUsers();
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        }

        $scope.saveUser = async function (user) {
            //if (user.avatar != user.avatarUrl) {
            //    user.avatar = user.avatarUrl;
            //}
            $rootScope.isBusy = true;
            var resp = await userServices.saveUser(user);
            if (resp && resp.isSucceed) {
                //$scope.activedUser = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.register = async function (user) {
            $rootScope.isBusy = true;
            var resp = await userServices.register(user);
            if (resp && resp.isSucceed) {
                $scope.activedUser = resp.data;
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };

        $scope.updateRoleStatus = async function (nav) {
            var userRole = {
                userId: nav.userId,
                roleId: nav.roleId,
                roleName: nav.description,
                isUserInRole: nav.isActived
            };
            $rootScope.isBusy = true;
            var resp = await userServices.updateRoleStatus(userRole);
            if (resp && resp.isSucceed) {
                $rootScope.showMessage('Thành công', 'success');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
            else {
                if (resp) { $rootScope.showErrors(resp.errors); }
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        };
    }]);

'use strict';
app.factory('UserServices', ['$http', 'CommonService', 'ngAppSettings'
    , function ($http, commonServices, ngAuthSettings) {

    //var serviceBase = 'http://ngauthenticationapi.azurewebsites.net/';

    var usersServiceFactory = {};
    var apiUrl = '/account/';
    
    var serviceBase = ngAuthSettings.serviceBase;
    
    var _getUserDemographicInfo = function () {
        var url = '/GetUserDemographicInfo';
        var req = {
            method: 'GET',
            url: serviceBase + url
        };

        return commonServices.getApiResult(req);
    };



    var _importUsers = function (strBase64) {
        var url = 'import-users';
        var req = {
            method: 'POST',
            url: apiUrl + url,
            data: JSON.stringify({ strBase64: strBase64 })
        };

        return commonServices.getApiResult(req);
    };

    var _getUsers = function (request) {

        var req = {
            method: 'POST',
            url: apiUrl + 'list',
            data: request
        };

        return commonServices.getApiResult(req);
    };

    var _getUser = async function (id, viewType) {
        var apiUrl = '/account/';
        var url = apiUrl + 'details/' + viewType;
        if (id) {
            url += '/' + id;
        }
        var req = {
            method: 'GET',
            url: url
        };
        return await commonServices.getApiResult(req)
    };

    var _updateRoleStatus = function (userInRole) {

        var req = {
            method: 'POST',
            url: serviceBase + '/account/user-in-role',
            data: JSON.stringify(userInRole)

        };

        return commonServices.getApiResult(req);
    };

    var _saveUser = async function (user) {
        var apiUrl = '/account/';
        var req = {
            method: 'POST',
            url: apiUrl + 'save',
            data: JSON.stringify(user)
        };
        return await commonServices.getApiResult(req)
    };

    var _register = async function (user) {
        var apiUrl = '/account/';
        var req = {
            method: 'POST',
            url: apiUrl + 'register',
            data: JSON.stringify(user)
        };
        return await commonServices.getApiResult(req)
    };

    var _removeUser = function (user) {
        var req = {
            method: 'POST',
            url: apiUrl + 'remove-user',
            data: JSON.stringify(user)
        };

        return commonServices.getApiResult(req);
    };

    usersServiceFactory.importUsers = _importUsers;
    usersServiceFactory.getUsers = _getUsers;
    usersServiceFactory.getUser = _getUser;
    usersServiceFactory.saveUser = _saveUser;
    usersServiceFactory.register = _register;
    usersServiceFactory.removeUser = _removeUser;
    usersServiceFactory.updateRoleStatus = _updateRoleStatus;
    usersServiceFactory.getUserDemographicInfo = _getUserDemographicInfo;
    return usersServiceFactory;

}]);

    'use strict';
    function PageDetailsController($scope, $element, $attrs) {
        var ctrl = this;
        ctrl.activedPage = null;
        ctrl.relatedPages = [];
        ctrl.data = [];
        ctrl.errors = [];
        ctrl.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };
        ctrl.loadPage = function (pageId) {
            ctrl.isBusy = true;
            var url = '/' + ctrl.currentLanguage + '/page/details/be/' + pageId;//byPage/' + pageId;
            ctrl.settings.method = "GET";
            ctrl.settings.url = url;// + '/true';
            ctrl.settings.data = ctrl.request;
            $.ajax(ctrl.settings).done(function (response) {
                if (response.isSucceed) {
                    ctrl.activedPage = response.data;
                    ctrl.initEditor();
                }
                ctrl.isBusy = false;
                ctrl.$apply();
            });
        };
        ctrl.loadPages = function (pageIndex) {
            ctrl.isBusy = true;
            if (pageIndex != undefined) {
                ctrl.request.pageIndex = pageIndex;
            }
            if (ctrl.request.fromDate != null) {
                ctrl.request.fromDate = ctrl.request.fromDate.toISOString();
            }
            if (ctrl.request.toDate != null) {
                ctrl.request.toDate = ctrl.request.toDate.toISOString();
            }
            var url = '/' + ctrl.currentLanguage + '/page/list';//byPage/' + pageId;
            ctrl.settings.method = "POST";
            ctrl.settings.url = url;// + '/true';
            ctrl.settings.data = ctrl.request;
            $.ajax(ctrl.settings).done(function (response) {
                (ctrl.data = response.data);

                $.each(ctrl.data.items, function (i, page) {
                    $.each(ctrl.activedPages, function (i, e) {
                        if (e.pageId == page.id) {
                            page.isHidden = true;
                        }
                    })
                })
                ctrl.isBusy = false;
                setTimeout(function () {
                    $('[data-toggle="popover"]').popover({
                        html: true,
                        content: function () {
                            var content = $(this).next('.popover-body');
                            return $(content).html();
                        },
                        title: function () {
                            var title = $(this).attr("data-popover-content");
                            return $(title).children(".popover-heading").html();
                        }
                    });
                }, 200);
                ctrl.$apply();
            });
        };

        ctrl.removePage = function (pageId) {
            if (confirm("Are you sure!")) {
                var url = '/' + ctrl.currentLanguage + '/page/delete/' + pageId;
                $.ajax({
                    method: 'GET',
                    url: url,
                    success: function (data) {
                        ctrl.loadPages();
                        ctrl.$apply();
                    },
                    error: function (a, b, c) {
                        console.log(a + " " + b + " " + c);
                    }
                });
            }
        };
        ctrl.savePage = function (page) {
            var url = '/' + ctrl.currentLanguage + '/page/save';
            $.ajax({
                method: 'POST',
                url: url,
                data: page,
                success: function (data) {
                    //ctrl.loadPages();
                    if (data.isSucceed) {
                        alert('success');
                    }
                    else {
                        alert('failed! ' + data.errors);
                    }
                },
                error: function (a, b, c) {
                    console.log(a + " " + b + " " + c);
                }
            });
        };

        ctrl.changeMedia = function (media) {
            var currentItem = null;
            if (ctrl.activedPage.mediaNavs == undefined) {
                ctrl.activedPage.mediaNavs = [];
            }
            $.each(ctrl.activedPage.mediaNavs, function (i, e) {
                if (e.mediaId == media.id) {
                    e.isActived = media.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    description: media.description != 'undefined' ? media.description : '',
                    image: media.fullPath,
                    mediaId: media.id,
                    page: ctrl.activedPage.id,
                    specificulture: media.specificulture,
                    position: 0,
                    priority: ctrl.activedMedias.length + 1,
                    isActived: true
                };
                media.isHidden = true;
                ctrl.activedPage.mediaNavs.push(currentItem);
            }
        }

        ctrl.changePage = function (page) {
            var currentItem = null;
            $.each(ctrl.activedPage.pageNavs, function (i, e) {
                if (e.relatedPageId == page.id) {
                    e.isActived = page.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    relatedPageId: page.id,
                    sourcePageId: $('#page-id').val(),
                    specificulture: page.specificulture,
                    priority: ctrl.activedPage.pageNavs.length + 1,
                    page: page,
                    isActived: true
                };
                page.isHidden = true;
                ctrl.activedPage.pageNavs.push(currentItem);
            }
        }


        ctrl.addProperty = function (type) {
            var i = $(".property").length;
            $.ajax({
                method: 'GET',
                url: '/' + ctrl.currentLanguage + '/Portal/' + type + '/AddEmptyProperty/' + i,
                success: function (data) {
                    $('#tbl-properties > tbody').append(data);
                    $(data).find('.prop-data-type').trigger('change');
                },
                error: function (a, b, c) {
                    console.log(a + " " + b + " " + c);
                }
            });
            ctrl.updateHero = function (hero, prop, value) {
                hero[prop] = value;
            };

            ctrl.deleteHero = function (hero) {
                var idx = ctrl.list.indexOf(hero);
                if (idx >= 0) {
                    ctrl.list.splice(idx, 1);
                }
            };
        }

        angular.module(appName).component('pageDetails', {
            templateUrl: 'pageDetails.html',
            controller: PageDetailsController
        });
    }




    'use strict';
    function ProductDetailsController($scope, $element, $attrs) {
        var ctrl = this;
        ctrl.activedData = null;
        ctrl.relatedProducts = [];
        ctrl.data = [];
        ctrl.errors = [];
        ctrl.range = function (max) {
            var input = [];
            for (var i = 1; i <= max; i += 1) input.push(i);
            return input;
        };
        ctrl.loadProduct = function (productId) {
            ctrl.isBusy = true;
            var url = '/' + ctrl.currentLanguage + '/product/details/be/' + productId;//byProduct/' + productId;
            ctrl.settings.method = "GET";
            ctrl.settings.url = url;// + '/true';
            ctrl.settings.data = ctrl.request;
            $.ajax(ctrl.settings).done(function (response) {
                if (response.isSucceed) {
                    ctrl.activedData = response.data;
                    ctrl.initEditor();
                }
                ctrl.isBusy = false;
                ctrl.$apply();
            });
        };
        ctrl.loadProducts = function (pageIndex) {
            ctrl.isBusy = true;
            if (pageIndex != undefined) {
                ctrl.request.pageIndex = pageIndex;
            }
            if (ctrl.request.fromDate != null) {
                ctrl.request.fromDate = ctrl.request.fromDate.toISOString();
            }
            if (ctrl.request.toDate != null) {
                ctrl.request.toDate = ctrl.request.toDate.toISOString();
            }
            var url = '/' + ctrl.currentLanguage + '/product/list';//byProduct/' + productId;
            ctrl.settings.method = "POST";
            ctrl.settings.url = url;// + '/true';
            ctrl.settings.data = ctrl.request;
            $.ajax(ctrl.settings).done(function (response) {
                (ctrl.data = response.data);

                $.each(ctrl.data.items, function (i, product) {
                    $.each(ctrl.activedDatas, function (i, e) {
                        if (e.productId == product.id) {
                            product.isHidden = true;
                        }
                    })
                })
                ctrl.isBusy = false;
                setTimeout(function () {
                    $('[data-toggle="popover"]').popover({
                        html: true,
                        content: function () {
                            var content = $(this).next('.popover-body');
                            return $(content).html();
                        },
                        title: function () {
                            var title = $(this).attr("data-popover-content");
                            return $(title).children(".popover-heading").html();
                        }
                    });
                }, 200);
                ctrl.$apply();
            });
        };

        ctrl.removeProduct = function (productId) {
            if (confirm("Are you sure!")) {
                var url = '/' + ctrl.currentLanguage + '/product/delete/' + productId;
                $.ajax({
                    method: 'GET',
                    url: url,
                    success: function (data) {
                        ctrl.loadProducts();
                        ctrl.$apply();
                    },
                    error: function (a, b, c) {
                        console.log(a + " " + b + " " + c);
                    }
                });
            }
        };
        ctrl.saveProduct = function (product) {
            var url = '/' + ctrl.currentLanguage + '/product/save';
            $.ajax({
                method: 'POST',
                url: url,
                data: product,
                success: function (data) {
                    //ctrl.loadProducts();
                    if (data.isSucceed) {
                        alert('success');
                    }
                    else {
                        alert('failed! ' + data.errors);
                    }
                },
                error: function (a, b, c) {
                    console.log(a + " " + b + " " + c);
                }
            });
        };

        ctrl.changeMedia = function (media) {
            var currentItem = null;
            if (ctrl.activedData.mediaNavs == undefined) {
                ctrl.activedData.mediaNavs = [];
            }
            $.each(ctrl.activedData.mediaNavs, function (i, e) {
                if (e.mediaId == media.id) {
                    e.isActived = media.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    description: media.description != 'undefined' ? media.description : '',
                    image: media.fullPath,
                    mediaId: media.id,
                    product: ctrl.activedData.id,
                    specificulture: media.specificulture,
                    position: 0,
                    priority: ctrl.activedMedias.length + 1,
                    isActived: true
                };
                media.isHidden = true;
                ctrl.activedData.mediaNavs.push(currentItem);
            }
        }

        ctrl.changeProduct = function (product) {
            var currentItem = null;
            $.each(ctrl.activedData.productNavs, function (i, e) {
                if (e.relatedProductId == product.id) {
                    e.isActived = product.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    relatedProductId: product.id,
                    sourceProductId: $('#product-id').val(),
                    specificulture: product.specificulture,
                    priority: ctrl.activedData.productNavs.length + 1,
                    product: product,
                    isActived: true
                };
                product.isHidden = true;
                ctrl.activedData.productNavs.push(currentItem);
            }
        }


        ctrl.addProperty = function (type) {
            var i = $(".property").length;
            $.ajax({
                method: 'GET',
                url: '/' + ctrl.currentLanguage + '/Portal/' + type + '/AddEmptyProperty/' + i,
                success: function (data) {
                    $('#tbl-properties > tbody').append(data);
                    $(data).find('.prop-data-type').trigger('change');
                },
                error: function (a, b, c) {
                    console.log(a + " " + b + " " + c);
                }
            });
            ctrl.updateHero = function (hero, prop, value) {
                hero[prop] = value;
            };

            ctrl.deleteHero = function (hero) {
                var idx = ctrl.list.indexOf(hero);
                if (idx >= 0) {
                    ctrl.list.splice(idx, 1);
                }
            };
        }

        angular.module(appName).component('productDetails', {
            templateUrl: 'productDetails.html',
            controller: ProductDetailsController
        });
    }



app.component('articleGeneral', {
    templateUrl: '/app-portal/pages/article/components/general/articleGeneral.html',
    controller: function ($scope) {
        var ctrl = this;
        ctrl.dataTypes = [
            {
                title: 'String',
                value:0
            },
            {
                title: 'Int',
                value: 1
            },
            {
                title: 'Image',
                value: 2
            },
            {
                title: 'Boolean',
                value: 7
            }
        ];
        ctrl.configurations = {
            core: {},
            plugins: {
                btnsDef: {
                    // Customizables dropdowns
                    image: {
                        dropdown: ['insertImage', 'upload', 'base64', 'noembed'],
                        ico: 'insertImage'
                    }
                },
                btns: [
                    ['viewHTML'],
                    ['undo', 'redo'],
                    ['formatting'],
                    ['strong', 'em', 'del', 'underline'],
                    ['link'],
                    ['image'],
                    ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],
                    ['unorderedList', 'orderedList'],
                    ['foreColor', 'backColor'],
                    ['preformatted'],
                    ['horizontalRule'],
                    ['fullscreen']
                ],
                plugins: {
                    // Add imagur parameters to upload plugin
                    upload: {
                        serverPath: 'https://api.imgur.com/3/image',
                        fileFieldName: 'image',
                        headers: {
                            'Authorization': 'Client-ID 9e57cb1c4791cea'
                        },
                        urlPropertyName: 'data.link'
                    }
                }
            }
        };
        ctrl.addProperty = function (type) {
            var i = $(".property").length;
            ctrl.article.properties.push({
                priority: 0,
                name: '',
                value: null,
                dataType: 0
            });
        };
        ctrl.initEditor = function() {
            setTimeout(function () {
                // Init Code editor
                $.each($('.code-editor'), function (i, e) {
                    var container = $(this);
                    var editor = ace.edit(e);
                    if (container.hasClass('json')) {
                        editor.session.setMode("ace/mode/json");
                    }
                    else {
                        editor.session.setMode("ace/mode/razor");
                    }
                    editor.setTheme("ace/theme/chrome");
                    //editor.setReadOnly(true);

                    editor.session.setUseWrapMode(true);
                    editor.setOptions({
                        maxLines: Infinity
                    });
                    editor.getSession().on('change', function (e) {
                        // e.type, etc
                        $(container).parent().find('.code-content').val(editor.getValue());
                    });
                })
                $.each($('.editor-content'), function (i, e) {
                    var $demoTextarea = $(e);
                    $demoTextarea.trumbowyg(ctrl.configurations.plugins);
                });
            }, 200)
        }
    },
    bindings: {
        article: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('articleMain', {
    templateUrl: '/app-portal/pages/article/components/main/articleMain.html',
    controller: ['$rootScope', '$scope',
        function ($rootScope, $scope) {
            var ctrl = this;
            ctrl.generateSeo = function () {
                if (ctrl.article) {
                    if (ctrl.article.seoName == null || ctrl.article.seoName == '') {
                        ctrl.article.seoName = $rootScope.generateKeyword(ctrl.article.title, '-');
                    }
                    if (ctrl.article.seoTitle == null || ctrl.article.seoTitle == '') {
                        ctrl.article.seoTitle = $rootScope.generateKeyword(ctrl.article.title, '-');
                    }
                    if (ctrl.article.seoDescription == null || ctrl.article.seoDescription == '') {
                        ctrl.article.seoDescription = $rootScope.generateKeyword(ctrl.article.title, '-');
                    }
                    if (ctrl.article.seoKeywords == null || ctrl.article.seoKeywords == '') {
                        ctrl.article.seoKeywords = $rootScope.generateKeyword(ctrl.article.title, '-');
                    }
                }
            }
        }
    ],
    bindings: {
        article: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('articleMedias', {
    templateUrl: '/app-portal/pages/article/components/medias/articleMedias.html',
    controller: function () {
        var ctrl = this;
        ctrl.activeMedia = function (media) {
            var currentItem = null;
            if (ctrl.article.mediaNavs == null) {
                ctrl.article.mediaNavs = [];
            }
            $.each(ctrl.article.mediaNavs, function (i, e) {
                if (e.mediaId == media.id) {
                    e.isActived = media.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    description: media.description != 'undefined' ? media.description : '',
                    image: media.fullPath,
                    mediaId: media.id,
                    article: ctrl.article.id,
                    specificulture: media.specificulture,
                    position: 0,
                    priority: ctrl.article.mediaNavs.length + 1,
                    isActived: true
                };
                media.isHidden = true;
                ctrl.article.mediaNavs.push(currentItem);
            }
        }
    },
    bindings: {
        article: '=',
        medias: '=',
        loadMedia: '&',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('articleModules', {
    templateUrl: '/app-portal/pages/article/components/modules/articleModules.html',
    bindings: {
        article: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('articleParents', {
    templateUrl: '/app-portal/pages/article/components/parents/articleParents.html',
    bindings: {
        article: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('articleRelated', {
    templateUrl: '/app-portal/pages/article/components/related/articleRelated.html',
    controller: function () {
        var ctrl = this;
        ctrl.activeArticle = function (model) {
            var currentItem = null;
            $.each(ctrl.article.articleNavs, function (i, e) {
                if (e.relatedArticleId == model.id) {
                    e.isActived = model.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    relatedArticleId: model.id,
                    sourceArticleId: ctrl.article.id,
                    specificulture: ctrl.article.specificulture,
                    priority: ctrl.article.articleNavs.length + 1,
                    relatedArticle: pr,
                    isActived: true
                };
                model.isHidden = true;
                ctrl.article.articleNavs.push(currentItem);
            }
        }
    },
    bindings: {
        article: '=',
        list: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('articleSeo', {
    templateUrl: '/app-portal/pages/article/components/seo/articleSeo.html',
    bindings: {
        article: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('customerMain', {
    templateUrl: '/app-portal/pages/customer/components/main/customer-main.html',
    bindings: {
        customer: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('customerOrders', {
    templateUrl: '/app-portal/pages/customer/components/orders/customer-orders.html',
    controller: ['$rootScope', 'OrderServices', function($rootScope, orderServices){
        var ctrl = this;
        ctrl.removeOrder = function (id) {
            $rootScope.showConfirm(ctrl, 'removeOrderConfirmed', [id], null, 'Remove Order', 'Are you sure');
        }

        ctrl.removeOrderConfirmed = async function (id) {
            var result = await orderServices.removeOrder(id);
            if (result.isSucceed) {
                $rootScope.showMessage('success', 'success');
                window.top.location = window.top.location.href;
            }
            else {
                $rootScope.showMessage('failed');
                $rootScope.isBusy = false;
                $scope.$apply();
            }
        }
    }],
    bindings: {
        customer: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('moduleMain', {
    templateUrl: '/app-portal/pages/module/components/main/main.html',
    controller: ['$rootScope', function ($rootScope) {
        var ctrl = this;
        ctrl.gennerateName = function () {
            if (!ctrl.module.id || ctrl.module.name === null || ctrl.module.name === '') {
                ctrl.module.name = $rootScope.generateKeyword(ctrl.module.title, '_');
            }
        };
    }],
    bindings: {
        module: '=',
    }
});

app.component('pageGeneral', {
    templateUrl: '/app-portal/pages/page/components/general/general.html',
    controller: function ($scope) {
        var ctrl = this;
        ctrl.dataTypes = [
            {
                title: 'String',
                value:0
            },
            {
                title: 'Int',
                value: 1
            },
            {
                title: 'Image',
                value: 2
            },
            {
                title: 'Boolean',
                value: 7
            }
        ];
        ctrl.configurations = {
            core: {},
            plugins: {
                btnsDef: {
                    // Customizables dropdowns
                    image: {
                        dropdown: ['insertImage', 'upload', 'base64', 'noembed'],
                        ico: 'insertImage'
                    }
                },
                btns: [
                    ['viewHTML'],
                    ['undo', 'redo'],
                    ['formatting'],
                    ['strong', 'em', 'del', 'underline'],
                    ['link'],
                    ['image'],
                    ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],
                    ['unorderedList', 'orderedList'],
                    ['foreColor', 'backColor'],
                    ['preformatted'],
                    ['horizontalRule'],
                    ['fullscreen']
                ],
                plugins: {
                    // Add imagur parameters to upload plugin
                    upload: {
                        serverPath: 'https://api.imgur.com/3/image',
                        fileFieldName: 'image',
                        headers: {
                            'Authorization': 'Client-ID 9e57cb1c4791cea'
                        },
                        urlPropertyName: 'data.link'
                    }
                }
            }
        };
        ctrl.addProperty = function (type) {
            var i = $(".property").length;
            ctrl.page.properties.push({
                priority: 0,
                name: '',
                value: null,
                dataType: 0
            });
        };
        ctrl.initEditor = function() {
            setTimeout(function () {
                // Init Code editor
                $.each($('.code-editor'), function (i, e) {
                    var container = $(this);
                    var editor = ace.edit(e);
                    if (container.hasClass('json')) {
                        editor.session.setMode("ace/mode/json");
                    }
                    else {
                        editor.session.setMode("ace/mode/razor");
                    }
                    editor.setTheme("ace/theme/chrome");
                    //editor.setReadOnly(true);

                    editor.session.setUseWrapMode(true);
                    editor.setOptions({
                        maxLines: Infinity
                    });
                    editor.getSession().on('change', function (e) {
                        // e.type, etc
                        $(container).parent().find('.code-content').val(editor.getValue());
                    });
                })
                $.each($('.editor-content'), function (i, e) {
                    var $demoTextarea = $(e);
                    $demoTextarea.trumbowyg(ctrl.configurations.plugins);
                });
            }, 200)
        }
    },
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('pageMain', {
    templateUrl: '/app-portal/pages/page/components/main/main.html',
    controller: ['$rootScope', '$scope', 'ngAppSettings', function ($rootScope, $scope) {
        var ctrl = this;
        ctrl.settings = $rootScope.globalSettings;
        ctrl.setPageType = function (type) {
            ctrl.page.type = $index;
        }
        ctrl.generateSeo = function () {
            if (ctrl.page) {
                if (ctrl.page.seoName == null || ctrl.page.seoName == '') {
                    ctrl.page.seoName = $rootScope.generateKeyword(ctrl.page.title, '-');
                }
                if (ctrl.page.seoTitle == null || ctrl.page.seoTitle == '') {
                    ctrl.page.seoTitle = $rootScope.generateKeyword(ctrl.page.title, '-');
                }
                if (ctrl.page.seoDescription == null || ctrl.page.seoDescription == '') {
                    ctrl.page.seoDescription = $rootScope.generateKeyword(ctrl.page.title, '-');
                }
                if (ctrl.page.seoKeywords == null || ctrl.page.seoKeywords == '') {
                    ctrl.page.seoKeywords = $rootScope.generateKeyword(ctrl.page.title, '-');
                }
            }
        }
    }],
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('pageModules', {
    templateUrl: '/app-portal/pages/page/components/modules/modules.html',
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('pageParents', {
    templateUrl: '/app-portal/pages/page/components/parents/parents.html',
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('pagePlugPlay', {
    templateUrl: '/app-portal/pages/page/components/plug-play/plug-play.html',
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productRelated', {
    templateUrl: '/app-portal/pages/product/components/related/productRelated.html',
    controller: function () {
        var ctrl = this;
        ctrl.activeProduct = function (pr) {
            var currentItem = null;
            $.each(ctrl.product.productNavs, function (i, e) {
                if (e.relatedProductId == pr.id) {
                    e.isActived = pr.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    relatedProductId: pr.id,
                    sourceProductId: ctrl.product.id,
                    specificulture: ctrl.product.specificulture,
                    priority: ctrl.product.productNavs.length + 1,
                    relatedProduct: pr,
                    isActived: true
                };
                pr.isHidden = true;
                ctrl.product.productNavs.push(currentItem);
            }
        }
    },
    bindings: {
        product: '=',
        list: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('pageSeo', {
    templateUrl: '/app-portal/pages/page/components/seo/seo.html',
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('portalPageMain', {
    templateUrl: '/app-portal/pages/portal-page/components/main/main.html',
    controller: ['$rootScope', '$scope', 'ngAppSettings', '$routeParams',function ($rootScope, $scope, ngAppSettings, $routeParams) {
        var ctrl = this;
        ctrl.settings = $rootScope.globalSettings;
        ctrl.setPageType = function (type) {
            ctrl.page.type = $index;
        };
        ctrl.generateKeyword = function (text) {
            if (!$routeParams.id) {
                ctrl.page.textKeyword = 'portal_' + text.replace(/[^a-zA-Z0-9]+/g, '_')
                    .replace(/([A-Z]+)([A-Z][a-z])/g, '$1-$2')
                    .replace(/([a-z])([A-Z])/g, '$1-$2')
                    .replace(/([0-9])([^0-9])/g, '$1-$2')
                    .replace(/([^0-9])([0-9])/g, '$1-$2')
                    .replace(/-+/g, '_')
                    .toLowerCase();
            }
        };
    }],
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('portalPageParents', {
    templateUrl: '/app-portal/pages/portal-page/components/parents/parents.html',    
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('portalPagePlugPlay', {
    templateUrl: '/app-portal/pages/portal-page/components/plug-play/plug-play.html',
    bindings: {
        page: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productGeneral', {
    templateUrl: '/app-portal/pages/product/components/general/productGeneral.html',
    controller: ['$rootScope', '$scope', 'ngAppSettings', function ($rootScope, $scope, ngAppSettings) {
        var ctrl = this;
        //ctrl.tags = ctrl.product.tags;
        ctrl.dataTypes = [
            {
                title: 'String',
                value: 0
            },
            {
                title: 'Int',
                value: 1
            },
            {
                title: 'Image',
                value: 2
            },
            {
                title: 'Boolean',
                value: 7
            }
        ];
        ctrl.configurations = ngAppSettings.editorConfigurations;
        ctrl.addProperty = function (type) {
            var i = $(".property").length;
            ctrl.product.properties.push({
                priority: 0,
                name: '',
                value: null,
                dataType: 0
            });
        };
        ctrl.initEditor = $rootScope.initEditor;
        ctrl.loadTags = function (query) {
            return [];
        };
    }],
    bindings: {
        product: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productMain', {
    templateUrl: '/app-portal/pages/product/components/main/productMain.html',
    controller: ['$rootScope', '$scope', 'ngAppSettings',
        function ($rootScope, $scope, ngAppSettings) {
            var ctrl = this;
            ctrl.translate = $rootScope.translate;
            ctrl.privacies = ngAppSettings.privacies;
            ctrl.formatPrice = function (price) {
                return price.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            };
            ctrl.generateSeo = function () {
                if (ctrl.product) {
                    if (ctrl.product.seoName == null || ctrl.product.seoName == '') {
                        ctrl.product.seoName = $rootScope.generateKeyword(ctrl.product.title, '-');
                    }
                    if (ctrl.product.seoTitle == null || ctrl.product.seoTitle == '') {
                        ctrl.product.seoTitle = $rootScope.generateKeyword(ctrl.product.title, '-');
                    }
                    if (ctrl.product.seoDescription == null || ctrl.product.seoDescription == '') {
                        ctrl.product.seoDescription = $rootScope.generateKeyword(ctrl.product.title, '-');
                    }
                    if (ctrl.product.seoKeywords == null || ctrl.product.seoKeywords == '') {
                        ctrl.product.seoKeywords = $rootScope.generateKeyword(ctrl.product.title, '-');
                    }
                }
            }
        }
    ],
    bindings: {
        product: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productMedias', {
    templateUrl: '/app-portal/pages/product/components/medias/productMedias.html',
    controller: ['$rootScope', function ($rootScope) {
        var ctrl = this;
        ctrl.medias = $rootScope.medias;
        ctrl.init = function () {
            if ($rootScope.medias) {
                angular.forEach(ctrl.medias, function (value, key) {
                    value.isActived = ctrl.checkActived(value) !== undefined;
                });
                
            }
        };
        ctrl.checkActived = function (item) {
            if (ctrl.product.mediaNavs) {
                return ctrl.product.mediaNavs.find(function (nav) {
                    return nav.mediaId === item.id;
                });
            }
        };
        ctrl.activeMedia = function (media) {
            var currentItem = null;
            if (ctrl.product.mediaNavs === null) {
                ctrl.product.mediaNavs = [];
            }
            $.each(ctrl.product.mediaNavs, function (i, e) {
                if (e.mediaId === media.id) {
                    e.isActived = media.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem === null) {
                currentItem = {
                    description: media.description !== 'undefined' ? media.description : '',
                    image: media.fullPath,
                    mediaId: media.id,
                    product: ctrl.product.id,
                    specificulture: media.specificulture,
                    position: 0,
                    priority: ctrl.product.mediaNavs.length + 1,
                    isActived: true
                };
                media.isHidden = true;
                ctrl.product.mediaNavs.push(currentItem);
            }
        };
    }],
    bindings: {
        product: '=',
        medias: '=',
        loadMedia: '&',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productParents', {
    templateUrl: '/app-portal/pages/product/components/parents/productParents.html',
    bindings: {
        product: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productModules', {
    templateUrl: '/app-portal/pages/product/components/modules/productModules.html',
    bindings: {
        product: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productRelated', {
    templateUrl: '/app-portal/pages/product/components/related/productRelated.html',
    controller: function () {
        var ctrl = this;
        ctrl.activeProduct = function (pr) {
            var currentItem = null;
            $.each(ctrl.product.productNavs, function (i, e) {
                if (e.relatedProductId == pr.id) {
                    e.isActived = pr.isActived;
                    currentItem = e;
                    return false;
                }
            });
            if (currentItem == null) {
                currentItem = {
                    relatedProductId: pr.id,
                    sourceProductId: ctrl.product.id,
                    specificulture: ctrl.product.specificulture,
                    priority: ctrl.product.productNavs.length + 1,
                    relatedProduct: pr,
                    isActived: true
                };
                pr.isHidden = true;
                ctrl.product.productNavs.push(currentItem);
            }
        }
    },
    bindings: {
        product: '=',
        list: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

app.component('productSeo', {
    templateUrl: '/app-portal/pages/product/components/seo/productSeo.html',
    bindings: {
        product: '=',
        onDelete: '&',
        onUpdate: '&'
    }
});

modules.component('rolePageNav', {
    templateUrl: '/app-portal/pages/role/components/role-page-navigation/role-page-navigations.html',
    controller: ['$rootScope', '$scope', 'ngAppSettings', 'RoleServices', function ($rootScope, $scope, ngAppSettings, roleServices) {
        var ctrl = this;
        ctrl.selected = null;
        ctrl.updateOrders = function (index) {
            ctrl.data.splice(index, 1);
            for (var i = 0; i < ctrl.data.length; i++) {
                ctrl.data[i].priority = i + 1;
            }
        };
        //ctrl.change = async function () {
        //    //var permission = ctrl.page.navPermission;
        //    //$rootScope.isBusy = true;
        //    //var resp = await roleServices.updatePermission(permission);
        //    //if (resp && resp.isSucceed) {
        //    //    $rootScope.showMessage('Thành công', 'success');
        //    //    $rootScope.isBusy = false;
        //    //    $scope.$apply();
        //    //}
        //    //else {
        //    //    if (resp) { $rootScope.showErrors(resp.errors); }
        //    //    $rootScope.isBusy = false;
        //    //    $scope.$apply();
        //    //}
        //};
    }],
    bindings: {
        prefix: '=',
        page: '=',
        callback: '&'
    }
});