var demo={initDashboardPageCharts:function(e,t){e=e||[50,150,100,190,130,90,150,160,120,140,190,95],chartColor="#eeeeee",gradientChartOptionsConfiguration={maintainAspectRatio:!1,legend:{display:!1},tooltips:{bodySpacing:4,mode:"nearest",intersect:0,position:"nearest",xPadding:10,yPadding:10,caretPadding:10},responsive:1,scales:{yAxes:[{display:0,ticks:{display:!1},gridLines:{zeroLineColor:"transparent",drawTicks:!1,display:!1,drawBorder:!1}}],xAxes:[{display:0,ticks:{display:!1},gridLines:{zeroLineColor:"transparent",drawTicks:!1,display:!1,drawBorder:!1}}]},layout:{padding:{left:0,right:0,top:15,bottom:15}}},gradientChartOptionsConfigurationWithNumbersAndGrid={maintainAspectRatio:!1,legend:{display:!1},tooltips:{bodySpacing:4,mode:"nearest",intersect:0,position:"nearest",xPadding:10,yPadding:10,caretPadding:10},responsive:!0,scales:{yAxes:[{gridLines:{zeroLineColor:"transparent",drawBorder:!1}}],xAxes:[{display:0,ticks:{display:!1},gridLines:{zeroLineColor:"transparent",drawTicks:!1,display:!1,drawBorder:!1}}]},layout:{padding:{left:0,right:0,top:15,bottom:15}}};var a=document.getElementById("bigDashboardChart").getContext("2d"),i=a.createLinearGradient(500,0,100,0);i.addColorStop(0,"#80b6f4"),i.addColorStop(1,chartColor);var r=a.createLinearGradient(0,200,0,50);r.addColorStop(0,"rgba(128, 182, 244, 0)"),r.addColorStop(1,"rgba(255, 255, 255, 0.24)");new Chart(a,{type:"bar",data:{labels:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],datasets:[{type:"line",label:"Incomes",borderColor:chartColor,pointBorderColor:chartColor,pointBackgroundColor:"red",pointHoverBackgroundColor:"#1e3d60",pointHoverBorderColor:chartColor,pointBorderWidth:1,pointHoverRadius:7,pointHoverBorderWidth:2,pointRadius:5,fill:!0,backgroundColor:r,borderWidth:2,data:e},{label:"Services",backgroundColor:"yellow",data:t}]},options:{layout:{padding:{left:20,right:20,top:0,bottom:0}},maintainAspectRatio:!1,tooltips:{backgroundColor:"#fff",titleFontColor:"#333",bodyFontColor:"#666",bodySpacing:4,xPadding:12,mode:"nearest",intersect:0,position:"nearest"},legend:{position:"bottom",fillStyle:"#FFF",display:!1},scales:{yAxes:[{ticks:{fontColor:"rgba(255,255,255,0.4)",fontStyle:"bold",beginAtZero:!0,maxTicksLimit:5,padding:10},gridLines:{drawTicks:!0,drawBorder:!1,display:!0,color:"rgba(255,255,255,0.1)",zeroLineColor:"transparent"}}],xAxes:[{gridLines:{zeroLineColor:"transparent",display:!1},ticks:{padding:10,fontColor:"rgba(255,255,255,0.4)",fontStyle:"bold"}}]}}})}};function PageDetailsController(e,t,a){var i=this;i.activedPage=null,i.relatedPages=[],i.data=[],i.errors=[],i.range=function(e){for(var t=[],a=1;a<=e;a+=1)t.push(a);return t},i.loadPage=function(e){i.isBusy=!0;var t="/"+i.currentLanguage+"/page/details/be/"+e;i.settings.method="GET",i.settings.url=t,i.settings.data=i.request,$.ajax(i.settings).done(function(e){e.isSucceed&&(i.activedPage=e.data,i.initEditor()),i.isBusy=!1,i.$apply()})},i.loadPages=function(e){i.isBusy=!0,void 0!==e&&(i.request.pageIndex=e),null!==i.request.fromDate&&(i.request.fromDate=i.request.fromDate.toISOString()),null!==i.request.toDate&&(i.request.toDate=i.request.toDate.toISOString());var t="/"+i.currentLanguage+"/page/list";i.settings.method="POST",i.settings.url=t,i.settings.data=i.request,$.ajax(i.settings).done(function(e){i.data=e.data,$.each(i.data.items,function(e,t){$.each(i.activedPages,function(e,a){a.pageId===t.id&&(t.isHidden=!0)})}),i.isBusy=!1,setTimeout(function(){$('[data-toggle="popover"]').popover({html:!0,content:function(){var e=$(this).next(".popover-body");return $(e).html()},title:function(){var e=$(this).attr("data-popover-content");return $(e).children(".popover-heading").html()}})},200),i.$apply()})},i.removePage=function(e){if(confirm("Are you sure!")){var t="/"+i.currentLanguage+"/page/delete/"+e;$.ajax({method:"GET",url:t,success:function(e){i.loadPages(),i.$apply()},error:function(e,t,a){console.log(e+" "+t+" "+a)}})}},i.savePage=function(e){var t="/"+i.currentLanguage+"/page/save";$.ajax({method:"POST",url:t,data:e,success:function(e){e.isSucceed?alert("success"):alert("failed! "+e.errors)},error:function(e,t,a){console.log(e+" "+t+" "+a)}})},i.changeMedia=function(e){var t=null;void 0===i.activedPage.mediaNavs&&(i.activedPage.mediaNavs=[]),$.each(i.activedPage.mediaNavs,function(a,i){if(i.mediaId===e.id)return i.isActived=e.isActived,t=i,!1}),null===t&&(t={description:"undefined"!==e.description?e.description:"",image:e.fullPath,mediaId:e.id,page:i.activedPage.id,specificulture:e.specificulture,position:0,priority:i.activedMedias.length+1,isActived:!0},e.isHidden=!0,i.activedPage.mediaNavs.push(t))},i.changePage=function(e){var t=null;$.each(i.activedPage.pageNavs,function(a,i){if(i.relatedPageId===e.id)return i.isActived=e.isActived,t=i,!1}),null===t&&(t={relatedPageId:e.id,sourcePageId:$("#page-id").val(),specificulture:e.specificulture,priority:i.activedPage.pageNavs.length+1,page:e,isActived:!0},e.isHidden=!0,i.activedPage.pageNavs.push(t))},i.addProperty=function(e){var t=$(".property").length;$.ajax({method:"GET",url:"/"+i.currentLanguage+"/Portal/"+e+"/AddEmptyProperty/"+t,success:function(e){$("#tbl-properties > tbody").append(e),$(e).find(".prop-data-type").trigger("change")},error:function(e,t,a){console.log(e+" "+t+" "+a)}}),i.updateHero=function(e,t,a){e[t]=a},i.deleteHero=function(e){var t=i.list.indexOf(e);t>=0&&i.list.splice(t,1)}},angular.module(appName).component("pageDetails",{templateUrl:"pageDetails.html",controller:PageDetailsController})}function ProductDetailsController(e,t,a){var i=this;i.activedData=null,i.relatedProducts=[],i.data=[],i.errors=[],i.range=function(e){for(var t=[],a=1;a<=e;a+=1)t.push(a);return t},i.loadProduct=function(e){i.isBusy=!0;var t="/"+i.currentLanguage+"/product/details/be/"+e;i.settings.method="GET",i.settings.url=t,i.settings.data=i.request,$.ajax(i.settings).done(function(e){e.isSucceed&&(i.activedData=e.data,i.initEditor()),i.isBusy=!1,i.$apply()})},i.loadProducts=function(e){i.isBusy=!0,void 0!==e&&(i.request.pageIndex=e),null!==i.request.fromDate&&(i.request.fromDate=i.request.fromDate.toISOString()),null!==i.request.toDate&&(i.request.toDate=i.request.toDate.toISOString());var t="/"+i.currentLanguage+"/product/list";i.settings.method="POST",i.settings.url=t,i.settings.data=i.request,$.ajax(i.settings).done(function(e){i.data=e.data,$.each(i.data.items,function(e,t){$.each(i.activedDatas,function(e,a){a.productId===t.id&&(t.isHidden=!0)})}),i.isBusy=!1,setTimeout(function(){$('[data-toggle="popover"]').popover({html:!0,content:function(){var e=$(this).next(".popover-body");return $(e).html()},title:function(){var e=$(this).attr("data-popover-content");return $(e).children(".popover-heading").html()}})},200),i.$apply()})},i.removeProduct=function(e){if(confirm("Are you sure!")){var t="/"+i.currentLanguage+"/product/delete/"+e;$.ajax({method:"GET",url:t,success:function(e){i.loadProducts(),i.$apply()},error:function(e,t,a){console.log(e+" "+t+" "+a)}})}},i.saveProduct=function(e){var t="/"+i.currentLanguage+"/product/save";$.ajax({method:"POST",url:t,data:e,success:function(e){e.isSucceed?alert("success"):alert("failed! "+e.errors)},error:function(e,t,a){console.log(e+" "+t+" "+a)}})},i.changeMedia=function(e){var t=null;void 0===i.activedData.mediaNavs&&(i.activedData.mediaNavs=[]),$.each(i.activedData.mediaNavs,function(a,i){if(i.mediaId===e.id)return i.isActived=e.isActived,t=i,!1}),null===t&&(t={description:"undefined"!==e.description?e.description:"",image:e.fullPath,mediaId:e.id,product:i.activedData.id,specificulture:e.specificulture,position:0,priority:i.activedMedias.length+1,isActived:!0},e.isHidden=!0,i.activedData.mediaNavs.push(t))},i.changeProduct=function(e){var t=null;$.each(i.activedData.productNavs,function(a,i){if(i.relatedProductId===e.id)return i.isActived=e.isActived,t=i,!1}),null===t&&(t={relatedProductId:e.id,sourceProductId:$("#product-id").val(),specificulture:e.specificulture,priority:i.activedData.productNavs.length+1,product:e,isActived:!0},e.isHidden=!0,i.activedData.productNavs.push(t))},i.addProperty=function(e){var t=$(".property").length;$.ajax({method:"GET",url:"/"+i.currentLanguage+"/Portal/"+e+"/AddEmptyProperty/"+t,success:function(e){$("#tbl-properties > tbody").append(e),$(e).find(".prop-data-type").trigger("change")},error:function(e,t,a){console.log(e+" "+t+" "+a)}}),i.updateHero=function(e,t,a){e[t]=a},i.deleteHero=function(e){var t=i.list.indexOf(e);t>=0&&i.list.splice(t,1)}},angular.module(appName).component("productDetails",{templateUrl:"productDetails.html",controller:ProductDetailsController})}app.controller("AppSettingsController",["$scope","$rootScope","ngAppSettings","$routeParams","$timeout","$location","AuthService","CommonService","AppSettingsServices",function(e,t,a,i,r,o,n,s,l){e.appSettings=null,e.errors=[],e.statuses=a.contentStatuses,e.getAppSettings=async function(a){t.isBusy=!0;var i=await l.getAppSettings();i&&i.isSucceed?(e.appSettings=JSON.stringify(i.data),t.initEditor(),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.loadAppSettings=async function(){t.isBusy=!0;i.id;var a=await l.getAppSettings();a.isSucceed?(e.appSettings=a.data,t.isBusy=!1,e.$apply()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply());var r=await s.getSettings();r.isSucceed?(e.settings=r.data,t.isBusy=!1,e.$apply()):t.isBusy=!1},e.saveAppSettings=async function(a){t.isBusy=!0;var i=await l.saveAppSettings(a);i&&i.isSucceed?(e.appSettings=i.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),e.$apply())}}]),app.factory("AppSettingsServices",["$http","$rootScope","CommonService",function(e,t,a){var i={};t.globalSettings;return i.getAppSettings=async function(){var e={method:"GET",url:"/portal/app-settings/details"};return await a.getApiResult(e)},i.saveAppSettings=async function(e){var t={method:"POST",url:"/portal/app-settings/save",data:JSON.stringify(e)};return await a.getApiResult(t)},i}]),app.controller("ArticleController",["$scope","$rootScope","ngAppSettings","$routeParams","ArticleService",function(e,t,a,i,r){BaseCtrl.call(this,e,t,i,a,r),e.preview=function(e){e.editUrl="/portal/article/details/"+e.id,t.preview("article",e,e.title,"modal-lg")}}]),app.factory("ArticleService",["BaseService",function(e){return e.init("article"),e}]),app.controller("ConfigurationController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","ConfigurationService","CommonService",function(e,t,a,i,r,o,n){BaseCtrl.call(this,e,t,i,a,o),e.cates=["Site","System"],e.settings=t.globalSettings,e.saveCallback=function(){n.initAllSettings().then(function(){r.path("/portal/configuration/list")})},e.removeCallback=function(){n.initAllSettings().then(function(){r.path("/portal/configuration/list")})}}]),app.factory("ConfigurationService",["BaseService","CommonService",function(e,t){var a=Object.create(e);a.init("configuration");return a.uploadConfiguration=async function(e){if(void 0!==e.file&&null!==e.file){var a=new FormData;a.append(e.file.name,e.file),a.append("fileFolder",e.folder),a.append("title",e.title),a.append("description",e.description);var i={url:this.prefixUrl+"/upload",type:"POST",headers:{},contentType:!1,processData:!1,data:a};return await t.getApiResult(i)}},a}]),app.controller("CultureController",["$scope","$rootScope","ngAppSettings","$routeParams","CultureService","CommonService",function(e,t,a,i,r,o){e.cultures=[{specificulture:"en-us",fullName:"United States - English (Default)",icon:"flag-icon-us"},{specificulture:"fr-dz",fullName:"Algeria - Français",icon:"flag-icon-dz"},{specificulture:"es-ar",fullName:"Argentina - Español",icon:"flag-icon-ar"},{specificulture:"en-au",fullName:"Australia - English",icon:"flag-icon-au"},{specificulture:"nl-be",fullName:"België - Nederlands",icon:"flag-icon-be"},{specificulture:"fr-be",fullName:"Belgique - Français",icon:"flag-icon-be"},{specificulture:"es-bo",fullName:"Bolivia - Español",icon:"flag-icon-bo"},{specificulture:"bs-ba",fullName:"Bosna i Hercegovina – Bosanski",icon:"flag-icon-ba"},{specificulture:"pt-br",fullName:"Brasil - Português",icon:"flag-icon-br"},{specificulture:"en-ca",fullName:"Canada - English",icon:"flag-icon-ca"},{specificulture:"fr-ca",fullName:"Canada - Français",icon:"flag-icon-ca"},{specificulture:"cs-cz",fullName:"Česká Republika - Čeština",icon:"flag-icon-cz"},{specificulture:"es-cl",fullName:"Chile - Español",icon:"flag-icon-cl"},{specificulture:"es-co",fullName:"Colombia - Español",icon:"flag-icon-co"},{specificulture:"es-cr",fullName:"Costa Rica - Español",icon:"flag-icon-cr"},{specificulture:"sr-latn-me",fullName:"Crna Gora - Srpski",icon:"flag-icon-me"},{specificulture:"en-cy",fullName:"Cyprus - English",icon:"flag-icon-cy"},{specificulture:"da-dk",fullName:"Danmark - Dansk",icon:"flag-icon-dk"},{specificulture:"de-de",fullName:"Deutschland - Deutsch",icon:"flag-icon-de"},{specificulture:"es-ec",fullName:"Ecuador - Español",icon:"flag-icon-ec"},{specificulture:"et-ee",fullName:"Eesti - Eesti",icon:"flag-icon-ee"},{specificulture:"en-eg",fullName:"Egypt - English",icon:"flag-icon-eg"},{specificulture:"es-sv",fullName:"El Salvador - Español",icon:"flag-icon-sv"},{specificulture:"es-es",fullName:"España - Español",icon:"flag-icon-es"},{specificulture:"fr-fr",fullName:"France - Français",icon:"flag-icon-fr"},{specificulture:"es-gt",fullName:"Guatemala - Español",icon:"flag-icon-gt"},{specificulture:"en-gulf",fullName:"Gulf - English",icon:"flag-icon-lf"},{specificulture:"es-hn",fullName:"Honduras - Español",icon:"flag-icon-hn"},{specificulture:"en-hk",fullName:"Hong Kong SAR - English",icon:"flag-icon-hk"},{specificulture:"hr-hr",fullName:"Hrvatska - Hrvatski",icon:"flag-icon-hr"},{specificulture:"en-in",fullName:"India - English",icon:"flag-icon-in"},{specificulture:"id-id",fullName:"Indonesia - Bahasa Indonesia",icon:"flag-icon-id"},{specificulture:"en-ie",fullName:"Ireland - English",icon:"flag-icon-ie"},{specificulture:"is-is",fullName:"Ísland - Íslenska",icon:"flag-icon-is"},{specificulture:"it-it",fullName:"Italia - Italiano",icon:"flag-icon-it"},{specificulture:"en-jo",fullName:"Jordan - English",icon:"flag-icon-jo"},{specificulture:"lv-lv",fullName:"Latvija - Latviešu",icon:"flag-icon-lv"},{specificulture:"en-lb",fullName:"Lebanon - English",icon:"flag-icon-lb"},{specificulture:"lt-lt",fullName:"Lietuva - Lietuvių",icon:"flag-icon-lt"},{specificulture:"hu-hu",fullName:"Magyarország - Magyar",icon:"flag-icon-hu"},{specificulture:"en-my",fullName:"Malaysia - English",icon:"flag-icon-my"},{specificulture:"en-mt",fullName:"Malta - English",icon:"flag-icon-mt"},{specificulture:"es-mx",fullName:"México - Español",icon:"flag-icon-mx"},{specificulture:"fr-ma",fullName:"Morocco - Français",icon:"flag-icon-ma"},{specificulture:"nl-nl",fullName:"Nederland - Nederlands",icon:"flag-icon-nl"},{specificulture:"en-nz",fullName:"New Zealand - English",icon:"flag-icon-nz"},{specificulture:"es-ni",fullName:"Nicaragua - Español",icon:"flag-icon-ni"},{specificulture:"en-ng",fullName:"Nigeria - English",icon:"flag-icon-ng"},{specificulture:"nb-no",fullName:"Norge - Bokmål",icon:"flag-icon-no"},{specificulture:"de-at",fullName:"Österreich - Deutsch",icon:"flag-icon-at"},{specificulture:"en-pk",fullName:"Pakistan - English",icon:"flag-icon-pk"},{specificulture:"es-pa",fullName:"Panamá - Español",icon:"flag-icon-pa"},{specificulture:"es-py",fullName:"Paraguay - Español",icon:"flag-icon-py"},{specificulture:"es-pe",fullName:"Perú - Español",icon:"flag-icon-pe"},{specificulture:"en-ph",fullName:"Philippines - English",icon:"flag-icon-ph"},{specificulture:"pl-pl",fullName:"Polska - Polski",icon:"flag-icon-pl"},{specificulture:"pt-pt",fullName:"Portugal - Português",icon:"flag-icon-pt"},{specificulture:"es-pr",fullName:"Puerto Rico - Español",icon:"flag-icon-pr"},{specificulture:"es-do",fullName:"República Dominicana - Español",icon:"flag-icon-do"},{specificulture:"ro-md",fullName:"Republica Moldova - Română",icon:"flag-icon-md"},{specificulture:"ro-ro",fullName:"România - Română",icon:"flag-icon-ro"},{specificulture:"en-sa",fullName:"Saudi Arabia - English",icon:"flag-icon-sa"},{specificulture:"de-ch",fullName:"Schweiz - Deutsch",icon:"flag-icon-ch"},{specificulture:"en-sg",fullName:"Singapore - English",icon:"flag-icon-sg"},{specificulture:"sl-si",fullName:"Slovenija - Slovenščina",icon:"flag-icon-si"},{specificulture:"sk-sk",fullName:"Slovensko - Slovenčina",icon:"flag-icon-sk"},{specificulture:"en-za",fullName:"South Africa - English",icon:"flag-icon-za"},{specificulture:"sr-latn-rs",fullName:"Srbija - Srpski",icon:"flag-icon-rs"},{specificulture:"en-lk",fullName:"Sri Lanka - English",icon:"flag-icon-lk"},{specificulture:"fr-ch",fullName:"Suisse - Français",icon:"flag-icon-ch"},{specificulture:"fi-fi",fullName:"Suomi - Suomi",icon:"flag-icon-fi"},{specificulture:"sv-se",fullName:"Sverige - Svenska",icon:"flag-icon-se"},{specificulture:"fr-tn",fullName:"Tunisia - Français",icon:"flag-icon-tn"},{specificulture:"tr-tr",fullName:"Türkiye - Türkçe",icon:"flag-icon-tr"},{specificulture:"en-gb",fullName:"United Kingdom - English",icon:"flag-icon-gb"},{specificulture:"en-us",fullName:"United States - English",icon:"flag-icon-us"},{specificulture:"es-uy",fullName:"Uruguay - Español",icon:"flag-icon-uy"},{specificulture:"es-ve",fullName:"Venezuela - Español",icon:"flag-icon-ve"},{specificulture:"vi-vn",fullName:"Việt Nam - Tiếng việt",icon:"flag-icon-vn"},{specificulture:"el-gr",fullName:"Ελλάδα - Ελληνικά",icon:"flag-icon-gr"},{specificulture:"ru-by",fullName:"Беларусь - Беларуская",icon:"flag-icon-by"},{specificulture:"bg-bg",fullName:"България - Български",icon:"flag-icon-bg"},{specificulture:"ru-kz",fullName:"Казахстан - Русский",icon:"flag-icon-kz"},{specificulture:"ru-ru",fullName:"Россия - Русский",icon:"flag-icon-ru"},{specificulture:"uk-ua",fullName:"Україна - Українська",icon:"flag-icon-ua"},{specificulture:"he-il",fullName:"ישראל - עברית",icon:"flag-icon-il"},{specificulture:"ar-iq",fullName:"العراق - العربية",icon:"flag-icon-iq"},{specificulture:"ar-sa",fullName:"المملكة العربية السعودية - العربية",icon:"flag-icon-sa"},{specificulture:"ar-ly",fullName:"ليبيا - العربية",icon:"flag-icon-ly"},{specificulture:"ar-eg",fullName:"مصر - العربية",icon:"flag-icon-eg"},{specificulture:"ar-gulf",fullName:"دول الخليج - العربية",icon:"flag-icon-lf"},{specificulture:"th-th",fullName:"ไทย - ไทย",icon:"flag-icon-th"},{specificulture:"ko-kr",fullName:"대한민국 - 한국어",icon:"flag-icon-kr"},{specificulture:"zh-cn",fullName:"中国 - 简体中文",icon:"flag-icon-cn"},{specificulture:"zh-tw",fullName:"台灣 - 繁體中文",icon:"flag-icon-tw"},{specificulture:"ja-jp",fullName:"日本 - 日本語",icon:"flag-icon-jp"},{specificulture:"zh-hk",fullName:"香港特別行政區 - 繁體中文",icon:"flag-icon-hk"}],e.selected=null,BaseCtrl.call(this,e,t,i,a,r),e.saveCallback=function(){o.initAllSettings(),window.location.href="/portal/culture/list"},e.removeCallback=function(){o.initAllSettings(),window.location.href="/portal/culture/list"},e.changeData=function(t){t&&(e.activedData.specificulture=t.specificulture,e.activedData.fullName=t.fullName,e.activedData.icon=t.icon)}}]),app.factory("CultureService",["BaseService",function(e){var t=Object.create(e);t.init("culture");return t.syncTemplates=async function(e){var t={method:"GET",url:"/culture/sync/"+e};return await commonService.getApiResult(t)},t.updateInfos=async function(e){var t={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await commonService.getApiResult(t)},t}]),app.controller("CustomerController",["$scope","$rootScope","ngAppSettings","$routeParams","$timeout","$location","CustomerServices",function(e,t,a,i,r,o,n){e.request=angular.copy(a.request),e.request.contentStatuses=["Active"],e.request.status="0",e.activedCustomer=null,e.relatedCustomers=[],t.isBusy=!1,e.data={pageIndex:0,pageSize:1,totalItems:0},e.errors=[],e.range=function(e){for(var t=[],a=1;a<=e;a+=1)t.push(a);return t},e.loadCustomer=async function(){t.isBusy=!0;var a=i.id,r=await n.getCustomer(a,"portal");r.isSucceed?(e.activedCustomer=r.data,t.initEditor(),t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.loadCustomers=async function(a){if(void 0!==a&&(e.request.pageIndex=a),null!==e.request.fromDate){var i=new Date(e.request.fromDate);e.request.fromDate=i.toISOString()}if(null!==e.request.toDate){i=new Date(e.request.toDate);e.request.toDate=i.toISOString()}var r=await n.getCustomers(e.request);r&&r.isSucceed?(e.data=r.data,$.each(e.data.items,function(t,a){$.each(e.activedCustomers,function(e,t){t.customerId===a.id&&(a.isHidden=!0)})}),t.isBusy=!1,e.$apply()):(r&&t.showErrors(r.errors),e.$apply())},e.removeCustomer=function(a){t.showConfirm(e,"removeCustomerConfirmed",[a],null,"Remove Customer","Are you sure")},e.removeCustomerConfirmed=async function(a){(await n.removeCustomer(a)).isSucceed?(t.showMessage("success","success"),e.loadCustomers()):(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.saveCustomer=async function(a){a.content=$(".editor-content").val();var i=await n.saveCustomer(a);i&&i.isSucceed?(e.activedCustomer=i.data,t.showMessage("Thành công","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),e.$apply())}}]),app.factory("CustomerServices",["$http","$rootScope","CommonService",function(e,t,a){var i={};t.globalSettings;return i.getCustomer=async function(e,t){var i="/queen-beauty/customer/details/"+t;e&&(i+="/"+e);var r={method:"GET",url:i};return await a.getApiResult(r)},i.initCustomer=async function(e){var t={method:"GET",url:"/queen-beauty/customer/init/"+e};return await a.getApiResult(t)},i.getCustomers=async function(e){var t={method:"POST",url:"/queen-beauty/customer/list",data:JSON.stringify(e)};return await a.getApiResult(t)},i.removeCustomer=async function(e){var t={method:"GET",url:"/queen-beauty/customer/delete/"+e};return await a.getApiResult(t)},i.saveCustomer=async function(e){var t={method:"POST",url:"/queen-beauty/customer/save",data:JSON.stringify(e)};return await a.getApiResult(t)},i}]),app.controller("DashboardController",["$scope","$rootScope","ngAppSettings","$timeout","$location","DashboardServices",function(e,t,a,i,r,o){e.pageClass="page-dashboard",$(".side-nav li").removeClass("active"),$(".side-nav .page-dashboard").addClass("active"),e.data={totalPage:0,totalArticle:0,totalProduct:0,totalUser:0},e.users=[],e.$on("$viewContentLoaded",function(){t.isBusy=!1}),e.getDashboardInfo=async function(){t.isBusy=!0;var a=await o.getDashboardInfo();a.isSucceed?(e.data=a.data,t.isBusy=!1,e.$apply(),e.getChart()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.getChart=function(){var e=document.getElementById("myChart");new Chart(e,{type:"bar",data:{labels:["Red","Blue","Yellow","Green","Purple","Orange"],datasets:[{label:"# of Votes",data:[12,19,3,5,2,3],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}}]),app.factory("DashboardServices",["$http","CommonService",function(e,t){var a={};return a.getDashboardInfo=async function(){var e={method:"GET",url:"/portal/dashboard"};return await t.getApiResult(e)},a}]),app.controller("FileController",["$scope","$rootScope","ngAppSettings","$routeParams","$timeout","$location","AuthService","FileServices",function(e,t,a,i,r,o,n,s){e.request={pageSize:"10",pageIndex:0,status:"2",orderBy:"CreatedDateTime",direction:"1",fromDate:null,toDate:null,keyword:"",key:""},e.activedFile=null,e.relatedFiles=[],t.isBusy=!1,e.data={pageIndex:0,pageSize:1,totalItems:0},e.errors=[],e.range=function(e){for(var t=[],a=1;a<=e;a+=1)t.push(a);return t},e.loadPage=async function(t){t&&(e.request.key+=""!==e.request.key?"/":"",e.request.key+=t),o.url("/portal/file/list?folder="+encodeURIComponent(e.request.key))},e.loadFile=async function(){t.isBusy=!0,e.listUrl="/portal/file/list?folder="+i.folder,t.isBusy=!0;var a=await s.getFile(i.folder,i.filename);a.isSucceed?(e.activedFile=a.data,t.isBusy=!1,e.$apply()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.loadFiles=async function(a){a?(e.request.key+=""!==e.request.key?"/":"",e.request.key+=a):e.request.key=i.folder?i.folder:"",t.isBusy=!0;var r=await s.getFiles(e.request);r&&r.isSucceed?(e.data=r.data,$.each(e.data.items,function(t,a){$.each(e.activedFiles,function(e,t){t.fileId===a.id&&(a.isHidden=!0)})}),t.isBusy=!1,e.$apply()):(r&&t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.removeFile=async function(a){if(confirm("Are you sure!")){t.isBusy=!0;var i=await s.removeFile(a);i&&i.isSucceed?e.loadFiles():(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())}},e.saveFile=async function(a){t.isBusy=!0;var i=await s.saveFile(a);i&&i.isSucceed?(e.activedFile=i.data,t.showMessage("Thành công","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())}}]),app.factory("FileServices",["$http","$rootScope","CommonService",function(e,t,a){var i={};t.globalSettings;return i.getFile=async function(e,t){var i={method:"GET",url:"/file/details?folder="+e+"&filename="+t};return await a.getApiResult(i)},i.initFile=async function(e){var t={method:"GET",url:"/file/init/"+e};return await a.getApiResult(t)},i.getFiles=async function(e){var t={method:"POST",url:"/file/list",data:JSON.stringify(e)};return await a.getApiResult(t)},i.removeFile=async function(e){var t={method:"GET",url:"/file/delete/"+e};return await a.getApiResult(t)},i.saveFile=async function(e){var t={method:"POST",url:"/file/save",data:JSON.stringify(e)};return await a.getApiResult(t)},i}]),app.controller("ImportFileController",["$scope","$rootScope","ImportFileServices","TranslatorService","GlobalSettingsService",function(e,t,a,i,r){e.importFile={title:"",description:"",postedFile:{file:null,fullPath:"",folderName:"Import",fileFolder:"Import",fileName:"",extension:"",content:"",fileStream:""}},e.importType="Language",e.types=["Language","Configuration"],e.errors=[],e.saveImportFile=async function(o,n){t.isBusy=!0;var s=await a.saveImportFile(o.postedFile,n);if(s&&s.isSucceed)switch(e.activedImportFile=s.data,t.showMessage("Success","success"),n){case"Language":return i.reset(t.globalSettings.lang).then(function(){window.location.href="/portal/language/list"}),!1;case"Configuration":return r.reset(t.globalSettings.lang).then(function(){window.location.href="/portal/configuration/list"}),!1}else s&&t.showErrors(s.errors),t.isBusy=!1,e.$apply()}}]),app.factory("ImportFileServices",["$http","$rootScope","CommonService",function(e,t,a){var i={},r=t.globalSettings;return i.saveImportFile=async function(e,t){var i={method:"POST",url:"/portal/"+r.lang+"/import/"+t,data:JSON.stringify(e)};return await a.getApiResult(i)},i}]),app.controller("LanguageController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","LanguageService","CommonService",function(e,t,a,i,r,o,n){BaseCtrl.call(this,e,t,i,a,o),e.languageFile={file:null,fullPath:"",folder:"Language",title:"",description:""},e.cates=[{title:"Common",prefix:""},{title:"Portal",prefix:"portal_"},{title:"Frontend",prefix:"fe_"}],e.cate=e.cates[0],e.dataTypes=a.dataTypes,e.saveCallback=function(){n.initAllSettings().then(function(){r.path("/portal/language/list")})},e.removeCallback=function(){n.initAllSettings().then(function(){r.path("/portal/language/list")})},e.generateDefault=function(t,a){i.id||(e.activedData.defaultValue=t,e.activedData.keyword=a.prefix+t.replace(/[^a-zA-Z0-9]+/g,"_").replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/([0-9])([^0-9])/g,"$1-$2").replace(/([^0-9])([0-9])/g,"$1-$2").replace(/-+/g,"_").toLowerCase())}}]),app.factory("LanguageService",["BaseService","CommonService",function(e,t){var a=Object.create(e);a.init("language");return a.uploadLanguage=async function(e){if(void 0!==e.file&&null!==e.file){var a=new FormData;a.append(e.file.name,e.file),a.append("fileFolder",e.folder),a.append("title",e.title),a.append("description",e.description);var i={url:this.prefixUrl+"/upload",type:"POST",headers:{},contentType:!1,processData:!1,data:a};return await t.getApiResult(i)}},a}]),app.controller("loginController",["$rootScope","$scope","ngAppSettings","$location","AuthService","ngAppSettings",function(e,t,a,i,r,o){r.authentication&&r.authentication.isAuth&&r.authentication.isAdmin&&(r.referredUrl=i.path(),i.path("/portal")),t.pageClass="page-login",t.loginData={username:"",password:"",rememberme:!1},t.message="",t.$on("$viewContentLoaded",function(){e.isBusy=!1}),t.login=async function(){"/init/login"===r.referredUrl&&(r.referredUrl="/portal"),e.isBusy=!0,await r.login(t.loginData)&&(e.isBusy=!1,t.$apply())},t.authExternalProvider=function(e){var a=location.protocol+"//"+location.host+"/authcomplete.html",i=o.apiServiceBaseUri+"api/Account/ExternalLogin?provider="+e+"&response_type=token&client_id="+o.clientId+"&redirect_uri="+a;window.$windowScope=t;window.open(i,"Authenticate Account","location=0,status=0,width=600,height=750")},t.authCompletedCB=function(e){t.$apply(function(){if("False"===e.haslocalaccount)r.logOut(),r.externalAuthData={provider:e.provider,userName:e.external_user_name,externalAccessToken:e.external_access_token},i.path("/associate");else{var a={provider:e.provider,externalAccessToken:e.external_access_token};r.obtainAccessToken(a).then(function(e){i.path("/orders")},function(e){t.message=e.error_description})}})}}]),app.factory("ModuleArticleService",["$rootScope","CommonService","BaseService",function(e,t,a){var i=Object.create(a);i.init("module-article");return i.updateInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},i}]),app.controller("ModuleController",["$scope","$rootScope","ngAppSettings","$routeParams","ModuleService","SharedModuleDataService",function(e,t,a,i,r,o){BaseCtrl.call(this,e,t,i,a,r,"product"),e.contentUrl="",e.getSingleSuccessCallback=function(){e.activedData.id>0&&(e.contentUrl="/portal/module/data/"+e.activedData.id)},e.getListByType=async function(t){e.request.query="?type="+e.type,await e.getList(t)},e.defaultAttr={name:"",options:[],priority:0,dataType:7,isGroupBy:!1,isSelect:!1,isDisplay:!0,width:3},e.type="-1",e.settings=t.globalSettings,e.activedData=null,e.editDataUrl="",e.loadModuleDatas=async function(){t.isBusy=!0;var a=i.id;e.dataColumns=[];var o=await r.getSingle([a,"mvc"]);o.isSucceed?(e.activedData=o.data,e.editDataUrl="/portal/module-data/details/"+e.activedData.id,angular.forEach(e.activedData.columns,function(t,a){t.isDisplay&&e.dataColumns.push({title:t.title,name:t.name,filter:!0,type:0})}),t.isBusy=!1,e.$apply()):(t.showErrors(o.errors),t.isBusy=!1,e.$apply())},e.loadMoreModuleDatas=async function(a){if(e.request.query="&module_id="+e.activedData.id,void 0!==a&&(e.request.pageIndex=a),null!==e.request.fromDate){var i=new Date(e.request.fromDate);e.request.fromDate=i.toISOString()}if(null!==e.request.toDate){i=new Date(e.request.toDate);e.request.toDate=i.toISOString()}t.isBusy=!0;var r=await o.getModuleDatas(e.request);r&&r.isSucceed?(e.activedData.data=r.data,t.isBusy=!1,e.$apply()):(r&&t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.addAttr=function(){if(e.activedData){var t=angular.copy(e.defaultAttr);e.activedData.columns.push(t)}},e.addOption=function(e,t){var a=angular.element("#option_"+t).val();e.options.push(a),angular.element("#option_"+t).val("")},e.generateForm=function(){var t=document.createElement("module-form");t.setAttribute("class","row"),t.setAttribute("ng-controller","ModuleFormController"),t.setAttribute("ng-init","initModuleForm('"+e.activedData.name+"')"),angular.forEach(e.activedData.columns,function(e,a){var i;console.log(e);var r=document.createElement("label");switch(r.setAttribute("class","control-label"),r.setAttribute("ng-bind","{{data.title}}"),e.dataType){case 1:(i=document.createElement("input")).setAttribute("type","datetime-local");break;case 2:(i=document.createElement("input")).setAttribute("type","date");break;case 3:(i=document.createElement("input")).setAttribute("type","time");break;case 5:(i=document.createElement("input")).setAttribute("type","tel");break;case 6:(i=document.createElement("input")).setAttribute("type","number");break;case 8:(i=document.createElement("trumbowyg")).setAttribute("options","{}"),i.setAttribute("type","number");break;case 9:i=document.createElement("textarea");break;default:(i=document.createElement("input")).setAttribute("type","text"),t.appendChild(i)}i.setAttribute("ng-model","data.jItem["+e.name+"].value"),i.setAttribute("placeholder","{{$ctrl.title}}"),t.appendChild(r),t.appendChild(i)}),console.log(t),e.activedData.formView.content=t.innerHTML},e.generateName=function(e){e.name=t.generateKeyword(e.title,"_")},e.removeAttr=function(t){e.activedData&&e.activedData.columns.splice(t,1)},e.removeData=function(a){e.activedData&&t.showConfirm(e,"removeDataConfirmed",[a],null,"Remove Data","Are you sure")},e.removeDataConfirmed=async function(a){t.isBusy=!0,(await o.removeModuleData(a)).isSucceed?e.loadModuleDatas():(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.updateModuleDataField=async function(a,i){(await o.saveFields(a.id,i,a[i])).isSucceed?e.loadModuleDatas():(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.updateDataInfos=async function(a){t.isBusy=!0;var i=await o.updateInfos(a);i&&i.isSucceed?(e.activedPage=i.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.loadArticles=async function(){t.isBusy=!0;var a=i.id;e.articleRequest.query+="&page_id="+a;var r=await pageArticleService.getList(e.articleRequest);r.isSucceed?(e.pageData.articles=r.data,t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.selectedCol=null,e.dragoverCallback=function(e,t,a,i){},e.insertColCallback=function(e,t,a,i){console.log("insert ",e,t,a,i)}}]),app.factory("ModuleService",["BaseService",function(e){var t=Object.create(e);return t.init("module"),t}]),app.controller("ModuleArticleController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","ModuleArticleService","CommonService",function(e,t,a,i,r,o,n){BaseCtrl.call(this,e,t,i,a,o),e.cates=["Site","System"],e.others=[],e.settings=t.globalSettings,e.moduleId=i.id,e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction,e.translate=t.translate,e.getList=async function(){t.isBusy=!0;var a=i.id;e.request.query="&module_id="+a,e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction;var r=await o.getList(e.request);r.isSucceed?(e.data=r.data,t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.remove=function(a,i){t.showConfirm(e,"removeConfirmed",[a,i],null,"Remove","Are you sure")},e.removeConfirmed=async function(a,i){t.isBusy=!0,(await o.delete(a,i)).isSucceed?(e.removeCallback&&t.executeFunctionByName("removeCallback",e.removeCallbackArgs,e),e.getList()):(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.saveCallback=function(){},e.removeCallback=function(){},e.saveOthers=async function(){var a=await o.saveList(e.others);a.isSucceed?(e.getList(),e.$apply()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.updateInfos=async function(a){e.data.items.splice(a,1),t.isBusy=!0;for(var i=e.data.items[0].priority-1,r=0;r<e.data.items.length;r++)e.data.items[r].priority=i+r+1;var n=await o.updateInfos(e.data.items);n&&n.isSucceed?(e.activedPage=n.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(n&&t.showErrors(n.errors),t.isBusy=!1,e.$apply())}}]),app.factory("ModuleArticleService",["$rootScope","CommonService","BaseService",function(e,t,a){var i=Object.create(a);i.init("module-article");return i.delete=async function(e,a){var i={method:"GET",url:this.prefixUrl+"/delete/"+e+"/"+a};return await t.getApiResult(i)},i.updateInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},i}]),app.controller("ModuleDataController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","ModuleDataService","CommonService",function(e,t,a,i,r,o,n){BaseCtrl.call(this,e,t,i,a,o),e.cates=["Site","System"],e.others=[],e.settings=t.globalSettings,e.moduleId=i.moduleId,e.getList=async function(){t.isBusy=!0,e.request.query="&module_id="+e.moduleId;var a=await o.getList(e.request);a.isSucceed?(e.data=a.data,t.isBusy=!1,e.$apply()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.getSingle=async function(){t.isBusy=!0;var a=await o.getSingle(i.id,"portal");a&&a.isSucceed?(e.activedModuleData=a.data,t.initEditor(),t.isBusy=!1,e.$apply()):(a&&t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.remove=function(a,i){t.showConfirm(e,"removeConfirmed",[a,i],null,"Remove","Are you sure")},e.removeConfirmed=async function(a,i){t.isBusy=!0,(await o.delete(a,i)).isSucceed?(e.removeCallback&&t.executeFunctionByName("removeCallback",e.removeCallbackArgs,e),e.getList()):(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.saveCallback=function(){},e.removeCallback=function(){},e.saveOthers=async function(){var a=await o.saveList(e.others);a.isSucceed?(e.getList(),e.$apply()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply())}}]),app.factory("ModuleDataService",["$rootScope","CommonService","BaseService",function(e,t,a){var i=Object.create(a);i.init("module-data");return i.delete=async function(e,a){var i={method:"GET",url:this.prefixUrl+"/delete/"+e+"/"+a};return await t.getApiResult(i)},i.updateInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},i}]),app.controller("OrderController",["$scope","$rootScope","ngAppSettings","$routeParams","$timeout","$location","AuthService","OrderServices","ngAppSettings",function(e,t,a,i,r,o,n,s){e.request=angular.copy(a.request),e.request.contentStatuses=["Waiting","Serving","Rated","Finished"],e.request.status="2",e.activedOrder=null,e.relatedOrders=[],t.isBusy=!1,e.data={pageIndex:0,pageSize:1,totalItems:0,items:[]},e.errors=[],e.range=function(e){for(var t=[],a=1;a<=e;a+=1)t.push(a);return t},e.loadOrder=async function(){t.isBusy=!0;var a=i.id,r=await s.getOrder(a,"portal");r.isSucceed?(e.activedOrder=r.data,t.initEditor(),t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.loadOrders=async function(a){if(void 0!==a&&(e.request.pageIndex=a),null!==e.request.fromDate){var i=new Date(e.request.fromDate);e.request.fromDate=i.toISOString()}if(null!==e.request.toDate){i=new Date(e.request.toDate);e.request.toDate=i.toISOString()}t.isBusy=!0;var r=await s.getOrders(e.request);r&&r.isSucceed?(e.data=r.data,$.each(e.data.items,function(t,a){$.each(e.activedOrders,function(e,t){t.orderId===a.id&&(a.isHidden=!0)})}),t.isBusy=!1,e.$apply()):(r&&t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.removeOrder=function(a){t.showConfirm(e,"removeOrderConfirmed",[a],null,"Remove Order","Are you sure")},e.removeOrderConfirmed=async function(a){t.isBusy=!0,(await s.removeOrder(a)).isSucceed?e.loadOrders():(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.saveOrder=async function(a){a.content=$(".editor-content.content").val(),a.excerpt=$(".editor-content.excerpt").val(),t.isBusy=!0;var i=await s.saveOrder(a);i&&i.isSucceed?(e.activedOrder=i.data,t.showMessage("Thành công","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.preview=function(e){t.preview("order",e,e.title,"modal-lg")}}]),app.factory("OrderServices",["$http","$rootScope","CommonService",function(e,t,a){var i={},r=t.globalSettings;return i.getOrder=async function(e,t){var i="/"+r.lang+"/order/details/"+t;e&&(i+="/"+e);var o={method:"GET",url:i};return await a.getApiResult(o)},i.initOrder=async function(e){var t={method:"GET",url:"/"+r.lang+"/order/init/"+e};return await a.getApiResult(t)},i.getOrders=async function(e){var t={method:"POST",url:"/"+r.lang+"/order/list",data:JSON.stringify(e)};return await a.getApiResult(t)},i.removeOrder=async function(e){var t={method:"GET",url:"/"+r.lang+"/order/delete/"+e};return await a.getApiResult(t)},i.saveOrder=async function(e){var t={method:"POST",url:"/"+r.lang+"/order/save",data:JSON.stringify(e)};return await a.getApiResult(t)},i}]),app.controller("PageController",["$scope","$rootScope","$routeParams","ngAppSettings","PageService","PageArticleService","PagePageService",function(e,t,a,i,r,o,n){BaseCtrl.call(this,e,t,a,i,r),e.request.query="level=0",e.pageData={articles:[],products:[],data:[]},e.articleRequest=angular.copy(i.request),e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction,e.loadArticles=async function(){t.isBusy=!0;var i=a.id;e.articleRequest.query+="&page_id="+i;var r=await o.getList(e.articleRequest);r.isSucceed?(e.pageData.articles=r.data,t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.getListSuccessCallback=function(){e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction},e.showChilds=function(e){$("#childs-"+e).toggleClass("collapse")},e.updateInfos=async function(a){e.data.items.splice(a,1),t.isBusy=!0;for(var i=e.data.items[0].priority-1,o=0;o<e.data.items.length;o++)e.data.items[o].priority=i+o+1;var n=await r.updateInfos(e.data.items);n&&n.isSucceed?(e.activedPage=n.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(n&&t.showErrors(n.errors),t.isBusy=!1,e.$apply())},e.goUp=async function(e,t){e[t].priority-=1,e[t-1].priority+=1},e.goDown=async function(e,t){e[t].priority+=1,e[t-1].priority-=1},e.updatePagePage=async function(a){t.isBusy=!0;var i=await n.updateInfos(a);i&&i.isSucceed?(e.activedPage=i.data,t.showMessage("success","success"),e.getList()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())}}]),app.factory("PageService",["$rootScope","CommonService","BaseService",function(e,t,a){var i=Object.create(a);i.init("page");return i.updateInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},i}]),app.controller("PageArticleController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","PageArticleService","ArticleService","CommonService",function(e,t,a,i,r,o,n,s){BaseCtrl.call(this,e,t,i,a,o),e.cates=["Site","System"],e.others=[],e.settings=t.globalSettings,e.pageId=i.id,e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction,e.getList=async function(){t.isBusy=!0;var a=i.id;e.request.query="&page_id="+a;var r=await o.getList(e.request);e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction,r.isSucceed?(e.data=r.data,t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.remove=function(a,i){t.showConfirm(e,"removeConfirmed",[a,i],null,"Remove","Are you sure")},e.removeConfirmed=async function(a,i){t.isBusy=!0,(await o.delete(a,i)).isSucceed?(e.removeCallback&&t.executeFunctionByName("removeCallback",e.removeCallbackArgs,e),e.getList()):(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.saveCallback=function(){},e.removeCallback=function(){},e.saveOthers=async function(){var a=await o.saveList(e.others);a.isSucceed?(e.getList(),e.$apply()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.updateInfos=async function(a){e.data.items.splice(a,1),t.isBusy=!0;for(var i=e.data.items[0].priority-1,r=0;r<e.data.items.length;r++)e.data.items[r].priority=i+r+1;var n=await o.updateInfos(e.data.items);n&&n.isSucceed?(e.activedPage=n.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(n&&t.showErrors(n.errors),t.isBusy=!1,e.$apply())}}]),app.factory("PageArticleService",["$rootScope","CommonService","BaseService",function(e,t,a){var i=Object.create(a);i.init("page-article");return i.delete=async function(e,a){var i={method:"GET",url:this.prefixUrl+"/delete/"+e+"/"+a};return await t.getApiResult(i)},i.updateInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},i}]),app.controller("ProductController",["$scope","$rootScope","ngAppSettings","$routeParams","ProductService",function(e,t,a,i,r){BaseCtrl.call(this,e,t,i,a,r),e.preview=function(e){e.editUrl="/portal/product/details/"+e.id,t.preview("product",e,e.title,"modal-lg")}}]),app.factory("ProductService",["BaseService",function(e){var t=Object.create(e);return t.init("product"),t}]),app.controller("PermissionController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","PermissionService","CommonService",function(e,t,a,i,r,o,n){BaseCtrl.call(this,e,t,i,a,o),e.request.query="level=0",e.miOptions=a.miIcons,e.columns=[{title:"Keyword",name:"textKeyword",filter:!0,type:0},{title:"Default",name:"textDefault",filter:!0,type:0},{title:"Url",name:"url",filter:!0,type:0},{title:"Created Date",name:"createdDateTime",filter:!0,type:0}],e.initCurrentPath=async function(){await e.getSingle(),e.activedData.url=r.path(),e.$applyAsync()},e.updateInfos=async function(a){t.isBusy=!0;var i=await o.updateInfos(a);i&&i.isSucceed?(e.activedPage=i.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.updateChildInfos=async function(a){t.isBusy=!0;var i=await o.updateChildInfos(a);i&&i.isSucceed?(e.activedPage=i.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},$("#dlg-favorite").on("show.bs.modal",function(t){e.initCurrentPath()})}]),app.factory("PermissionService",["BaseService","CommonService",function(e,t){var a=Object.create(e);a.init("permission",!0);return a.updateInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},a.updateChildInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-child-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},a}]),app.controller("QueenDashboardController",["$scope","$rootScope","$timeout","$location","QueenDashboardServices",function(e,t,a,i,r){e.pageClass="page-dashboard",$(".side-nav li").removeClass("active"),$(".side-nav .page-dashboard").addClass("active"),e.data={totalPage:0,totalArticle:0,totalProduct:0,totalUser:0},e.users=[],e.$on("$viewContentLoaded",function(){t.isBusy=!1}),e.getDashboardInfo=async function(){var a=await r.getDashboardInfo();if(a.isSucceed){var i=[],o=[];angular.forEach(a.data.statitics,function(e,t){i.push(e.totalSpent),o.push(e.totalService)}),setTimeout(function(){demo.initDashboardPageCharts(i,o)},2e3),e.data=a.data,e.$apply()}else t.showErrors(a.errors),e.$apply()}}]),app.factory("QueenDashboardServices",["$http","CommonService",function(e,t){var a={};return a.getDashboardInfo=async function(){var e={method:"GET",url:"/en-us/queen-beauty/dashboard"};return await t.getApiResult(e)},a}]),app.controller("RoleController",["$scope","$rootScope","ngAppSettings","$routeParams","RoleService",function(e,t,a,i,r){BaseCtrl.call(this,e,t,i,a,r),e.role={name:""},e.createRole=async function(){t.isBusy=!0;var a=await r.createRole(e.role.name);a.isSucceed?(e.role.name="",e.getList()):(t.showMessage(a.errors),t.isBusy=!1,e.$apply())}}]),app.factory("RoleService",["BaseService","CommonService",function(e,t){var a=Object.create(e);a.init("role",!0);return a.createRole=function(e){var a={method:"POST",url:this.prefixUrl+"/create",data:JSON.stringify(e)};return t.getApiResult(a)},a.getPermissions=async function(){var e={method:"GET",url:this.prefixUrl+"/permissions"};return await t.getApiResult(e)},a.updatePermission=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-permission",data:JSON.stringify(e)};return await t.getApiResult(a)},a}]),app.controller("TemplateController",["$scope","$rootScope","$routeParams","$location","ngAppSettings","TemplateService",function(e,t,a,i,r,o){BaseCtrl.call(this,e,t,a,r,o),e.folderTypes=["Masters","Layouts","Pages","Modules","Forms","Edms","Products","Articles","Widgets"],e.loadFolder=function(e){i.url("/portal/template/list/"+a.themeId+"?folderType="+encodeURIComponent(e))},e.loadParams=async function(){t.isBusy=!0,e.folderType=a.folderType,e.themeId=a.themeId},e.getSingle=async function(){t.isBusy=!0;var i=a.id;e.folderType=a.folderType;var r=a.themeId;e.listUrl="/portal/template/list/"+r+"?folderType="+encodeURIComponent(e.folderType);var n=await o.getSingle(["portal",r,e.folderType,i]);n&&n.isSucceed?(e.activedData=n.data,t.isBusy=!1,e.$apply()):(n&&t.showErrors(n.errors),t.isBusy=!1,e.$apply())},e.getList=async function(i,r){if(e.themeId=r||a.themeId,e.request.key=a.folderType,e.folderType=a.folderType,e.folderType){if(void 0!==i&&(e.request.pageIndex=i),null!==e.request.fromDate){var n=new Date(e.request.fromDate);e.request.fromDate=n.toISOString()}if(null!==e.request.toDate){n=new Date(e.request.toDate);e.request.toDate=n.toISOString()}var s=await o.getList(e.request,[e.themeId]);s&&s.isSucceed?(e.data=s.data,t.isBusy=!1,e.$apply()):(s&&t.showErrors(s.errors),t.isBusy=!1,e.$apply())}else t.isBusy=!1}}]),app.factory("TemplateService",["BaseService",function(e){var t=Object.create(e);return t.init("template"),t}]),app.controller("ThemeController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","ThemeService","CommonService",function(e,t,a,i,r,o,n){BaseCtrl.call(this,e,t,i,a,o),e.syncTemplates=async function(a){t.isBusy=!0;var i=await o.syncTemplates(a);i.isSucceed?(e.activedTheme=i.data,t.isBusy=!1,e.$apply()):(t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.export=async function(a){t.isBusy=!0;var i=await o.export(a);i.isSucceed?(t.isBusy=!1,window.open(i.data,"_blank"),e.$apply()):(t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.saveCallback=function(){n.initAllSettings().then(function(){r.path("/portal/theme/list")})},e.removeCallback=function(){n.initAllSettings().then(function(){r.path("/portal/theme/list")})}}]),app.factory("ThemeService",["CommonService","BaseService",function(e,t){var a=Object.create(t);a.init("theme");return a.export=async function(t){var a={method:"GET",url:this.prefixUrl+"/export/"+t};return await e.getApiResult(a,"")},a.syncTemplates=async function(t){var a={method:"GET",url:this.prefixUrl+"/sync/"+t};return await e.getApiResult(a,"")},a}]),app.controller("UserController",["$scope","$rootScope","ngAppSettings","$routeParams","$timeout","$location","AuthService","UserServices",function(e,t,a,i,r,o,n,s){e.request={pageSize:"10",pageIndex:0,status:"2",orderBy:"CreatedDateTime",direction:"1",fromDate:null,toDate:null,keyword:""},e.mediaFile={file:null,fullPath:"",folder:"User",title:"",description:""},e.activedUser=null,e.relatedUsers=[],t.isBusy=!1,e.data={pageIndex:0,pageSize:1,totalItems:0},e.errors=[],e.range=function(e){for(var t=[],a=1;a<=e;a+=1)t.push(a);return t},e.loadUser=async function(){t.isBusy=!0;var a=i.id,r=await s.getUser(a,"portal");r.isSucceed?(e.activedUser=r.data,t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.loadUsers=async function(a){void 0!==a&&(e.request.pageIndex=a),t.isBusy=!0;var i=await s.getUsers(e.request);i&&i.isSucceed?(e.data=i.data,$.each(e.data.items,function(t,a){$.each(e.data,function(e,t){t.userId===a.id&&(a.isHidden=!0)})}),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.removeUser=function(a){t.showConfirm(e,"removeUserConfirmed",[a],null,"Remove User","Are you sure")},e.removeUserConfirmed=async function(a){t.isBusy=!0,(await s.removeUser(a)).isSucceed?e.loadUsers():(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.saveUser=async function(a){t.isBusy=!0;var i=await s.saveUser(a);i&&i.isSucceed?(t.showMessage("Thành công","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.register=async function(a){t.isBusy=!0;var i=await s.register(a);i&&i.isSucceed?(e.activedUser=i.data,t.showMessage("Thành công","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.updateRoleStatus=async function(a){var i={userId:a.userId,roleId:a.roleId,roleName:a.description,isUserInRole:a.isActived};t.isBusy=!0;var r=await s.updateRoleStatus(i);r&&r.isSucceed?(t.showMessage("Thành công","success"),t.isBusy=!1,e.$apply()):(r&&t.showErrors(r.errors),t.isBusy=!1,e.$apply())}}]),app.factory("UserServices",["$http","CommonService","ngAppSettings",function(e,t,a){var i={},r=a.serviceBase;return i.importUsers=function(e){var a={method:"POST",url:"/account/import-users",data:JSON.stringify({strBase64:e})};return t.getApiResult(a)},i.getUsers=function(e){var a={method:"POST",url:"/account/list",data:e};return t.getApiResult(a)},i.getUser=async function(e,a){var i="/account/details/"+a;e&&(i+="/"+e);var r={method:"GET",url:i};return await t.getApiResult(r)},i.saveUser=async function(e){var a={method:"POST",url:"/account/save",data:JSON.stringify(e)};return await t.getApiResult(a)},i.register=async function(e){var a={method:"POST",url:"/account/register",data:JSON.stringify(e)};return await t.getApiResult(a)},i.removeUser=function(e){var a={method:"POST",url:"/account/remove-user",data:JSON.stringify(e)};return t.getApiResult(a)},i.updateRoleStatus=function(e){var a={method:"POST",url:r+"/account/user-in-role",data:JSON.stringify(e)};return t.getApiResult(a)},i.getUserDemographicInfo=function(){var e={method:"GET",url:r+"/GetUserDemographicInfo"};return t.getApiResult(e)},i}]),app.controller("PageArticleController",["$scope","$rootScope","ngAppSettings","$routeParams","$location","PageArticleService","ArticleService","CommonService",function(e,t,a,i,r,o,n,s){BaseCtrl.call(this,e,t,i,a,o),e.cates=["Site","System"],e.others=[],e.settings=t.globalSettings,e.pageId=i.id,e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction,e.getList=async function(){t.isBusy=!0;var a=i.id;e.request.query="&page_id="+a;var r=await o.getList(e.request);e.canDrag="Priority"!==e.request.orderBy||"0"!==e.request.direction,r.isSucceed?(e.data=r.data,t.isBusy=!1,e.$apply()):(t.showErrors(r.errors),t.isBusy=!1,e.$apply())},e.remove=function(a,i){t.showConfirm(e,"removeConfirmed",[a,i],null,"Remove","Are you sure")},e.removeConfirmed=async function(a,i){t.isBusy=!0,(await o.delete(a,i)).isSucceed?(e.removeCallback&&t.executeFunctionByName("removeCallback",e.removeCallbackArgs,e),e.getList()):(t.showMessage("failed"),t.isBusy=!1,e.$apply())},e.saveCallback=function(){},e.removeCallback=function(){},e.saveOthers=async function(){var a=await o.saveList(e.others);a.isSucceed?(e.getList(),e.$apply()):(t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.updateInfos=async function(a){e.data.items.splice(a,1),t.isBusy=!0;for(var i=e.data.items[0].priority-1,r=0;r<e.data.items.length;r++)e.data.items[r].priority=i+r+1;var n=await o.updateInfos(e.data.items);n&&n.isSucceed?(e.activedPage=n.data,t.showMessage("success","success"),t.isBusy=!1,e.$apply()):(n&&t.showErrors(n.errors),t.isBusy=!1,e.$apply())}}]),app.factory("PagePageService",["$rootScope","CommonService","BaseService",function(e,t,a){var i=Object.create(a);i.init("page-page");return i.delete=async function(e,a){var i={method:"GET",url:this.prefixUrl+"/delete/"+e+"/"+a};return await t.getApiResult(i)},i.updateInfos=async function(e){var a={method:"POST",url:this.prefixUrl+"/update-infos",data:JSON.stringify(e)};return await t.getApiResult(a)},i}]),app.component("articleGeneral",{templateUrl:"/app/app-portal/pages/article/components/general/articleGeneral.html",controller:["ngAppSettings",function(e){var t=this;t.dataTypes=e.dataTypes,t.addProperty=function(e){$(".property").length;t.article.properties.push({priority:0,name:"",value:null,dataType:"7"})}}],bindings:{article:"=",onDelete:"&",onUpdate:"&"}}),app.component("articleMain",{templateUrl:"/app/app-portal/pages/article/components/main/articleMain.html",controller:["$rootScope","$scope",function(e,t){var a=this;a.generateSeo=function(){a.article&&(null!==a.article.seoName&&""!==a.article.seoName||(a.article.seoName=e.generateKeyword(a.article.title,"-")),null!==a.article.seoTitle&&""!==a.article.seoTitle||(a.article.seoTitle=e.generateKeyword(a.article.title,"-")),null!==a.article.seoDescription&&""!==a.article.seoDescription||(a.article.seoDescription=e.generateKeyword(a.article.title,"-")),null!==a.article.seoKeywords&&""!==a.article.seoKeywords||(a.article.seoKeywords=e.generateKeyword(a.article.title,"-")))}}],bindings:{article:"=",onDelete:"&",onUpdate:"&"}}),app.component("articleMedias",{templateUrl:"/app/app-portal/pages/article/components/medias/articleMedias.html",controller:function(){var e=this;e.activeMedia=function(t){var a=null;null===e.article.mediaNavs&&(e.article.mediaNavs=[]),$.each(e.article.mediaNavs,function(e,i){if(i.mediaId===t.id)return i.isActived=t.isActived,a=i,!1}),null===a&&(a={description:"undefined"!==t.description?t.description:"",image:t.fullPath,mediaId:t.id,article:e.article.id,specificulture:t.specificulture,position:0,priority:e.article.mediaNavs.length+1,isActived:!0},t.isHidden=!0,e.article.mediaNavs.push(a))}},bindings:{article:"=",medias:"=",loadMedia:"&",onDelete:"&",onUpdate:"&"}}),app.component("articleModules",{templateUrl:"/app/app-portal/pages/article/components/modules/articleModules.html",controller:["$rootScope","$scope","ngAppSettings","SharedModuleDataService",function(e,t,a,i){var r=this;r.request=angular.copy(a.request),r.translate=function(t,a,i){return e.translate(t,a,i)},r.removeData=function(t,a){e.showConfirm(r,"removeDataConfirmed",[t,a],null,"Remove Data","Are you sure")},r.removeDataConfirmed=async function(a,o){e.isBusy=!0,(await i.removeModuleData(a)).isSucceed?r.loadModuleDatas(o):(e.showMessage("failed"),e.isBusy=!1,t.$apply())},r.saveDataCallback=function(e){e&&r.loadModuleDatas(e.moduleId)},r.loadModuleDatas=async function(o,n){e.isBusy=!0,t.dataColumns=[];var s=angular.copy(a.request);s.query="?module_id="+o+"&article_id="+r.article.id,n&&(s.pageIndex=n);var l=await i.getModuleDatas(s);if(l.isSucceed){var c=findObjectByKey(r.article.moduleNavs,"moduleId",o);c&&(c.module.data=l.data),e.isBusy=!1,t.$apply()}else e.showErrors(l.errors),e.isBusy=!1,t.$apply()},r.updateDataInfos=async function(a){e.isBusy=!0;var r=await i.updateInfos(a);r&&r.isSucceed?(t.activedPage=r.data,e.showMessage("success","success"),e.isBusy=!1,t.$apply()):(r&&e.showErrors(r.errors),e.isBusy=!1,t.$apply())}}],bindings:{article:"=",onDelete:"&",onUpdate:"&"}}),app.component("articleParents",{templateUrl:"/app/app-portal/pages/article/components/parents/articleParents.html",bindings:{article:"=",onDelete:"&",onUpdate:"&"}}),app.component("articleRelated",{templateUrl:"/app/app-portal/pages/article/components/related/articleRelated.html",controller:function(){var e=this;e.activeArticle=function(t){var a=null;$.each(e.article.articleNavs,function(e,i){if(i.relatedArticleId===t.id)return i.isActived=t.isActived,a=i,!1}),null===a&&(a={relatedArticleId:t.id,sourceArticleId:e.article.id,specificulture:e.article.specificulture,priority:e.article.articleNavs.length+1,relatedArticle:pr,isActived:!0},t.isHidden=!0,e.article.articleNavs.push(a))}},bindings:{article:"=",list:"=",onDelete:"&",onUpdate:"&"}}),app.component("articleSeo",{templateUrl:"/app/app-portal/pages/article/components/seo/articleSeo.html",bindings:{article:"=",onDelete:"&",onUpdate:"&"}}),app.component("customerMain",{templateUrl:"/app/app-portal/pages/customer/components/main/customer-main.html",bindings:{customer:"=",onDelete:"&",onUpdate:"&"}}),app.component("customerOrders",{templateUrl:"/app/app-portal/pages/customer/components/orders/customer-orders.html",controller:["$rootScope","OrderServices",function(e,t){var a=this;a.removeOrder=function(t){e.showConfirm(a,"removeOrderConfirmed",[t],null,"Remove Order","Are you sure")},a.removeOrderConfirmed=async function(a){(await t.removeOrder(a)).isSucceed?(e.showMessage("success","success"),window.top.location=window.top.location.href):(e.showMessage("failed"),e.isBusy=!1,$scope.$apply())}}],bindings:{customer:"=",onDelete:"&",onUpdate:"&"}}),app.component("moduleMain",{templateUrl:"/app/app-portal/pages/module/components/main/main.html",controller:["$rootScope",function(e){var t=this;t.settings=e.globalSettings,t.gennerateName=function(){t.module.id&&null!==t.module.name&&""!==t.module.name||(t.module.name=e.generateKeyword(t.module.title,"_"))}}],bindings:{module:"="}}),app.component("pageGeneral",{templateUrl:"/app/app-portal/pages/page/components/general/general.html",controller:function(e){var t=this;t.dataTypes=[{title:"String",value:0},{title:"Int",value:1},{title:"Image",value:2},{title:"Boolean",value:7}],t.configurations={core:{},plugins:{btnsDef:{image:{dropdown:["insertImage","upload","base64","noembed"],ico:"insertImage"}},btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del","underline"],["link"],["image"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["foreColor","backColor"],["preformatted"],["horizontalRule"],["fullscreen"]],plugins:{upload:{serverPath:"https://api.imgur.com/3/image",fileFieldName:"image",headers:{Authorization:"Client-ID 9e57cb1c4791cea"},urlPropertyName:"data.link"}}}},t.addProperty=function(e){$(".property").length;t.page.properties.push({priority:0,name:"",value:null,dataType:0})},t.initEditor=function(){setTimeout(function(){$.each($(".code-editor"),function(e,t){var a=$(this),i=ace.edit(t);a.hasClass("json")?i.session.setMode("ace/mode/json"):i.session.setMode("ace/mode/razor"),i.setTheme("ace/theme/chrome"),i.session.setUseWrapMode(!0),i.setOptions({maxLines:1/0}),i.getSession().on("change",function(e){$(a).parent().find(".code-content").val(i.getValue())})}),$.each($(".editor-content"),function(e,a){$(a).trumbowyg(t.configurations.plugins)})},200)}},bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("pageMain",{templateUrl:"/app/app-portal/pages/page/components/main/main.html",controller:["$rootScope","$scope","ngAppSettings",function(e,t){var a=this;a.settings=e.globalSettings,a.setPageType=function(e){a.page.type=$index},a.generateSeo=function(){a.page&&(null!==a.page.seoName&&""!==a.page.seoName||(a.page.seoName=e.generateKeyword(a.page.title,"-")),null!==a.page.seoTitle&&""!==a.page.seoTitle||(a.page.seoTitle=e.generateKeyword(a.page.title,"-")),null!==a.page.seoDescription&&""!==a.page.seoDescription||(a.page.seoDescription=e.generateKeyword(a.page.title,"-")),null!==a.page.seoKeywords&&""!==a.page.seoKeywords||(a.page.seoKeywords=e.generateKeyword(a.page.title,"-")))}}],bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("pageModules",{templateUrl:"/app/app-portal/pages/page/components/modules/modules.html",bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("pageParents",{templateUrl:"/app/app-portal/pages/page/components/parents/parents.html",bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("pagePlugPlay",{templateUrl:"/app/app-portal/pages/page/components/plug-play/plug-play.html",bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("productRelated",{templateUrl:"/app/app-portal/pages/product/components/related/productRelated.html",controller:function(){var e=this;e.activeProduct=function(t){var a=null;$.each(e.product.productNavs,function(e,i){if(i.relatedProductId===t.id)return i.isActived=t.isActived,a=i,!1}),null===a&&(a={relatedProductId:t.id,sourceProductId:e.product.id,specificulture:e.product.specificulture,priority:e.product.productNavs.length+1,relatedProduct:t,isActived:!0},t.isHidden=!0,e.product.productNavs.push(a))}},bindings:{product:"=",list:"=",onDelete:"&",onUpdate:"&"}}),app.component("pageSeo",{templateUrl:"/app/app-portal/pages/page/components/seo/seo.html",controller:["$rootScope",function(e){this.translate=function(t){return e.translate(t)}}],bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("productGeneral",{templateUrl:"/app/app-portal/pages/product/components/general/productGeneral.html",controller:["$rootScope","$scope","ngAppSettings",function(e,t,a){var i=this;i.dataTypes=a.dataTypes,i.addProperty=function(e){$(".property").length;i.product.properties.push({priority:0,name:"",value:null,dataType:0})},i.initEditor=e.initEditor,i.loadTags=function(e){return[]}}],bindings:{product:"=",onDelete:"&",onUpdate:"&"}}),app.component("productMain",{templateUrl:"/app/app-portal/pages/product/components/main/productMain.html",controller:["$rootScope","$scope","ngAppSettings",function(e,t,a){var i=this;i.translate=e.translate,i.privacies=a.privacies,i.formatPrice=function(e){return e.replace(/\B(?=(\d{3})+(?!\d))/g,",")},i.generateSeo=function(){i.product&&(null!==i.product.seoName&&""!==i.product.seoName||(i.product.seoName=e.generateKeyword(i.product.title,"-")),null!==i.product.seoTitle&&""!==i.product.seoTitle||(i.product.seoTitle=e.generateKeyword(i.product.title,"-")),null!==i.product.seoDescription&&""!==i.product.seoDescription||(i.product.seoDescription=e.generateKeyword(i.product.title,"-")),null!==i.product.seoKeywords&&""!==i.product.seoKeywords||(i.product.seoKeywords=e.generateKeyword(i.product.title,"-")))}}],bindings:{product:"=",onDelete:"&",onUpdate:"&"}}),app.component("productMedias",{templateUrl:"/app/app-portal/pages/product/components/medias/productMedias.html",controller:["$rootScope",function(e){var t=this;t.medias=e.medias,t.init=function(){e.medias&&angular.forEach(t.medias,function(e,a){e.isActived=void 0!==t.checkActived(e)})},t.checkActived=function(e){if(t.product.mediaNavs)return t.product.mediaNavs.find(function(t){return t.mediaId===e.id})},t.activeMedia=function(e){var a=null;null===t.product.mediaNavs&&(t.product.mediaNavs=[]),$.each(t.product.mediaNavs,function(t,i){if(i.mediaId===e.id)return i.isActived=e.isActived,a=i,!1}),null===a&&(a={description:"undefined"!==e.description?e.description:"",image:e.fullPath,mediaId:e.id,product:t.product.id,specificulture:e.specificulture,position:0,priority:t.product.mediaNavs.length+1,isActived:!0},e.isHidden=!0,t.product.mediaNavs.push(a))}}],bindings:{product:"=",medias:"=",loadMedia:"&",onDelete:"&",onUpdate:"&"}}),app.component("productModules",{templateUrl:"/app/app-portal/pages/product/components/modules/productModules.html",bindings:{product:"=",onDelete:"&",onUpdate:"&"}}),app.component("productParents",{templateUrl:"/app/app-portal/pages/product/components/parents/productParents.html",bindings:{product:"=",onDelete:"&",onUpdate:"&"}}),app.component("productRelated",{templateUrl:"/app/app-portal/pages/product/components/related/productRelated.html",controller:function(){var e=this;e.activeProduct=function(t){var a=null;$.each(e.product.productNavs,function(e,i){if(i.relatedProductId===t.id)return i.isActived=t.isActived,a=i,!1}),null===a&&(a={relatedProductId:t.id,sourceProductId:e.product.id,specificulture:e.product.specificulture,priority:e.product.productNavs.length+1,relatedProduct:t,isActived:!0},t.isHidden=!0,e.product.productNavs.push(a))}},bindings:{product:"=",list:"=",onDelete:"&",onUpdate:"&"}}),app.component("productSeo",{templateUrl:"/app/app-portal/pages/product/components/seo/productSeo.html",bindings:{product:"=",onDelete:"&",onUpdate:"&"}}),app.component("permissionMain",{templateUrl:"/app/app-portal/pages/permission/components/main/main.html",controller:["$rootScope","$scope","ngAppSettings","$routeParams",function(e,t,a,i){var r=this;r.settings=e.globalSettings,r.miIcons=a.miIcons,r.setPageType=function(e){r.page.type=$index},r.generateKeyword=function(e){i.id||(r.page.textKeyword="portal_"+e.replace(/[^a-zA-Z0-9]+/g,"_").replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/([0-9])([^0-9])/g,"$1-$2").replace(/([^0-9])([0-9])/g,"$1-$2").replace(/-+/g,"_").toLowerCase())}}],bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("permissionParents",{templateUrl:"/app/app-portal/pages/permission/components/parents/parents.html",bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),app.component("permissionPlugPlay",{templateUrl:"/app/app-portal/pages/permission/components/plug-play/plug-play.html",bindings:{page:"=",onDelete:"&",onUpdate:"&"}}),modules.component("rolePageNav",{templateUrl:"/app/app-portal/pages/role/components/role-page-navigation/role-page-navigations.html",controller:["$rootScope","$scope","ngAppSettings","RoleService",function(e,t,a,i){var r=this;r.selected=null,r.updateOrders=function(e){r.data.splice(e,1);for(var t=0;t<r.data.length;t++)r.data[t].priority=t+1}}],bindings:{prefix:"=",page:"=",callback:"&"}}),modules.component("actions",{templateUrl:"/app/app-portal/components/actions/actions.html",controller:["$rootScope","$scope","$location",function(e,t,a){var i=this;i.translate=function(t){return e.translate(t)},i.back=function(){i.backUrl=i.backUrl||"/admin",a.url(i.backUrl)}}],bindings:{previewUrl:"=",backUrl:"=",contentUrl:"="}}),modules.component("filterList",{templateUrl:"/app/app-portal/components/filter-list/filter-list.html",controller:["$scope","$rootScope","ngAppSettings",function(e,t,a){var i=this;i.dateRange={fromDate:null,toDate:null},i.init=function(){i.orders=a.orders,i.directions=a.directions,i.pageSizes=a.pageSizes,i.statuses=[];var e=i.request.contentStatuses||a.contentStatuses;angular.forEach(e,function(e,t){i.statuses.push({value:t,title:e})})},i.updateDate=function(){Date.parse(i.dateRange.fromDate)?i.request.fromDate=new Date(i.dateRange.fromDate).toISOString():e.request.fromDate=null,Date.parse(i.dateRange.toDate)?i.request.toDate=new Date(i.dateRange.toDate).toISOString():i.request.toDate=null,i.callback({pageIndex:0})}}],bindings:{request:"=",callback:"&"}}),window.angular,app.component("headerNav",{templateUrl:"/app/app-portal/components/header-nav/headerNav.html",controller:["$rootScope","$location","CommonService","AuthService","TranslatorService","GlobalSettingsService",function(e,t,a,i,r,o){var n=this;i.authentication&&(n.avatar=i.authentication.avatar),o.fillGlobalSettings().then(function(e){n.settings=e}),n.translate=e.translate,n.getConfiguration=e.getConfiguration,n.changeLang=function(e,t){n.settings.lang=e,n.settings.langIcon=t,a.fillSettings(e).then(function(){r.reset(e).then(function(){o.reset(e).then(function(){window.top.location=location.href})})})},n.logOut=function(){e.logOut()},n.addFavorite=function(){$("#dlg-favorite").modal("show")},n.toggleSidebar=function(){$("#sidebar").toggleClass("active")},n.generateSitemap=async function(){e.isBusy=!0;var t=await a.genrateSitemap();window.top.location.href="/portal/file/details?folder="+t.fileFolder+"&filename="+t.fileName+t.extension}}],bindings:{breadCrumbs:"=",settings:"="}}),modules.component("hubMessages",{templateUrl:"/app/app-portal/components/hub-messages/hub-messages.html",controller:"HubMessagesController",bindings:{}}),app.controller("HubMessagesController",["$scope",function(e){BaseHub.call(this,e),e.init=function(){e.startConnection("portalhub")}}]),modules.component("jumbotrons",{templateUrl:"/app/app-portal/components/jumbotrons/jumbotrons.html",controller:["$rootScope","$scope","$location",function(e,t,a){this.translate=function(t){return e.translate(t)}}],bindings:{tagName:"=",tagType:"="}}),modules.component("mainSideBar",{templateUrl:"/app/app-portal/components/main-side-bar/main-side-bar.html",controller:["$rootScope","$scope","ngAppSettings","TranslatorService",function(e,t,a,i){var r=this;r.init=async function(){r.items=[{title:"portal_dashboard",shortTitle:"portal_short_dashboard",icon:"mi mi-Tiles",href:"/portal",subMenus:[]},{title:"portal_articles",shortTitle:"portal_articles",icon:"mi mi-ReadingList",href:"#",subMenus:[{title:"portal_create",href:"/portal/article/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/article/list",icon:"mi mi-List"}]},{title:"portal_pages",shortTitle:"portal_pages",icon:"mi mi-Page",href:"#",subMenus:[{title:"portal_create",href:"/portal/page/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/page/list",icon:"mi mi-List"}]},{title:"portal_modules",shortTitle:"portal_modules",icon:"mi mi-ResolutionLegacy",href:"#",subMenus:[{title:"portal_create",href:"/portal/module/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/module/list",icon:"mi mi-List"}]},{title:"portal_themes",shortTitle:"portal_themes",icon:"mi mi-Personalize",href:"#",subMenus:[{title:"portal_create",href:"/portal/theme/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/theme/list",icon:"mi mi-List"}]},{title:"portal_media",shortTitle:"Media",icon:"mi mi-Photo2",href:"#",subMenus:[{title:"portal_create",href:"/portal/media/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/media/list",icon:"mi mi-List"}]},{title:"portal_file",shortTitle:"File",icon:"mi mi-FileExplorer",href:"#",subMenus:[{title:"portal_create",href:"/portal/file/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/file/list",icon:"mi mi-List"}]},{title:"portal_users",shortTitle:"Users",icon:"mi mi-Contact",href:"#",subMenus:[{title:"portal_create",href:"/portal/user/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/user/list",icon:"mi mi-List"},{title:"Roles",href:"/portal/role/list",icon:"mi mi-Permissions"}]},{title:"portal_settings",shortTitle:"Settings",icon:"mi mi-Settings mi-spin",href:"#",subMenus:[{title:"portal_app_settings",href:"/portal/app-settings/details",icon:"mi mi-ViewAll"},{title:"portal_create",href:"/portal/configuration/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/configuration/list",icon:"mi mi-List"}]},{title:"portal_import",shortTitle:"portal_short_import",icon:"mi mi-Upload",href:"/portal/import",subMenus:[]},{title:"language",shortTitle:"Language",icon:"mi mi-TimeLanguage",href:"#",subMenus:[{title:"portal_create",href:"/portal/language/create",icon:"mi mi-Add"},{title:"List",href:"/portal/language/list",icon:"mi mi-List"}]},{title:"portal_cultures",shortTitle:"portal_short_cultures",icon:"mi mi-Globe mi-spin",href:"#",subMenus:[{title:"portal_create",href:"/portal/culture/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/culture/list",icon:"mi mi-List"}]},{title:"portal_permissions",shortTitle:"portal_short_portal_permissions",icon:"mi mi-LockscreenDesktop",href:"#",subMenus:[{title:"portal_create",href:"/portal/permission/create",icon:"mi mi-Add"},{title:"portal_list",href:"/portal/permission/list",icon:"mi mi-List"}]}]}}],bindings:{}}),modules.component("mainSideBarDynamic",{templateUrl:"/app/app-portal/components/main-side-bar-dynamic/main-side-bar-dynamic.html",controller:["$rootScope","$scope","ngAppSettings","RoleService","TranslatorService",function(e,t,a,i,r){var o=this;o.init=function(){o.roles&&(o.role=o.roles[0])}}],bindings:{roles:"=",activedRole:"=",translate:"&"}}),modules.component("mainSideBarItem",{templateUrl:"/app/app-portal/components/main-side-bar-item/main-side-bar-item.html",controller:["$rootScope",function(e){this.translate=e.translate}],bindings:{item:"="}}),modules.component("mainSideBarItemDynamic",{templateUrl:"/app/app-portal/components/main-side-bar-item-dynamic/main-side-bar-item-dynamic.html",controller:["$rootScope",function(e){this.translate=e.translate}],bindings:{iconSize:"=",linkStyle:"=",itemStyle:"=",item:"="}}),app.controller("MediaController",["$scope","$rootScope","ngAppSettings","$routeParams","MediaService","CommonService",function(e,t,a,i,r,o){BaseCtrl.call(this,e,t,i,a,r),e.activedData={title:"",description:"",status:2,mediaFile:{file:null,fullPath:"",folderName:"Media",fileFolder:"",fileName:"",extension:"",content:"",fileStream:""}},e.relatedMedias=[],e.uploadMedia=async function(){t.isBusy=!0;var a=await r.uploadMedia(e.mediaFile);a&&a.isSucceed?(e.activedMedia=a.data,e.getList(),e.$apply()):(a&&t.showErrors(a.errors),t.isBusy=!1,e.$apply())},e.selectFile=function(t,a){void 0!==t&&null!==t&&(e.mediaFile.folder="Media",e.mediaFile.file=t,e.getBase64(t))},e.getBase64=function(a){if(null===a||!e.postedFile)return null;t.isBusy=!0;var i=new FileReader;i.readAsDataURL(a),i.onload=function(){var r=i.result.indexOf(",")+1;i.result.substring(r);e.activedMedia.mediaFile.fileName=t.generateKeyword(a.name.substring(0,a.name.lastIndexOf(".")),"-"),e.activedMedia.mediaFile.extension=a.name.substring(a.name.lastIndexOf(".")),e.activedMedia.mediaFile.fileStream=i.result,t.isBusy=!1,e.$apply()},i.onerror=function(e){t.showErrors([e]),t.isBusy=!1}},e.togglePreview=function(e){e.isPreview=void 0===e.isPreview||!e.isPreview},e.clone=async function(a){t.isBusy=!0;var i=await r.cloneMedia(a);i&&i.isSucceed?(e.activedMedia=i.data,t.showMessage("Thành công","success"),t.isBusy=!1,e.$apply()):(i&&t.showErrors(i.errors),t.isBusy=!1,e.$apply())},e.saveCallback=function(){e.getList()},e.removeCallback=function(){e.getList()}}]),modules.component("mixSelectIcons",{templateUrl:"/app/app-portal/components/mix-select-icons/mix-select-icons.html",controller:["$rootScope","$scope","$location",function(e,t,a){var i=this;i.translate=function(t){return e.translate(t)},i.select=function(e){i.data=e}}],bindings:{data:"=",prefix:"=",options:"="}}),modules.component("modalFavorite",{templateUrl:"/app/app-portal/components/modal-favorite/modal-favorite.html",controller:"PermissionController",bindings:{message:"="}}),modules.component("modalNavArticles",{templateUrl:"/app/app-portal/components/modal-nav-articles/modal-nav-articles.html",controller:["$rootScope","$scope","ngAppSettings","ArticleService",function(e,t,a,i){var r=this;r.request=angular.copy(a.request),r.navs=[],r.data={items:[]},r.loadArticles=async function(a){if(r.request.query=r.query+r.srcId,void 0!==a&&(r.request.pageIndex=a),null!==r.request.fromDate){var o=new Date(r.request.fromDate);r.request.fromDate=o.toISOString()}if(null!==r.request.toDate){o=new Date(r.request.toDate);r.request.toDate=o.toISOString()}var n=await i.getList(r.request);n.isSucceed?(r.data=n.data,r.navs=[],angular.forEach(n.data.items,function(t){var a={priority:t.priority,description:t.title,articleId:t.id,image:t.thumbnailUrl,specificulture:e.configurationService.get("lang"),article:t,status:2,isActived:!1};a[r.srcField]=r.srcId,r.navs.push(a)}),e.isBusy=!1,t.$apply()):(e.showErrors(n.errors),e.isBusy=!1,t.$apply())},r.saveSelected=function(){r.selected=e.filterArray(r.navs,"isActived",!0),setTimeout(()=>{r.save().then(()=>{r.loadArticles()})},500)}}],bindings:{srcField:"=",srcId:"=",query:"=",selected:"=",save:"&"}}),modules.component("templateEditor",{templateUrl:"/app/app-portal/components/template-editor/templateEditor.html",controller:["$scope","$rootScope","$routeParams","ngAppSettings","GlobalSettingsService","TemplateService",function(e,t,a,i,r,o){BaseCtrl.call(this,e,t,a,i,o);var n=this;n.selectTemplate=function(t){n.template=t,e.$broadcast("updateContentCodeEditors",[])},n.new=function(){n.template.id=0},n.init=async function(){if(n.folderType&&!n.folderType){var a=r.get("themeId"),i=await o.getSingle(["portal",a,n.folderType]);i&&i.isSucceed?(i.data.fileName="new",n.templates.splice(0,0,i.data),t.isBusy=!1,e.$apply()):i&&(t.showErrors(i.errors),t.isBusy=!1,e.$apply())}}}],bindings:{template:"=",templates:"=",folderType:"="}}),modules.component("urlAlias",{templateUrl:"/app/app-portal/components/url-alias/url-alias.html",controller:["$scope",function(e){}],bindings:{urlAlias:"=",callback:"&"}});